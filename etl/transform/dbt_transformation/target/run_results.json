{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-03-25T23:02:35.688379Z", "invocation_id": "8baea010-5c83-4f08-90c0-d96d87fd72b8", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T23:02:02.057769Z", "completed_at": "2025-03-25T23:02:02.070825Z"}, {"name": "execute", "started_at": "2025-03-25T23:02:02.071310Z", "completed_at": "2025-03-25T23:02:02.810158Z"}], "thread_id": "main", "execution_time": 0.752389, "adapter_response": {}, "message": "dbt_transformation.on-run-start.0 passed", "failures": 0, "unique_id": "operation.dbt_transformation.dbt_transformation-on-run-start-0", "compiled": true, "compiled_code": "\n    CREATE or REPLACE TABLE SKILLPATH_DB.RAW_DATA.STG_EDX_RAW (RAW_CONTENT VARIANT);\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T23:02:02.811506Z", "completed_at": "2025-03-25T23:02:02.820984Z"}, {"name": "execute", "started_at": "2025-03-25T23:02:02.821666Z", "completed_at": "2025-03-25T23:02:04.197751Z"}], "thread_id": "main", "execution_time": 1.386245, "adapter_response": {}, "message": "dbt_transformation.on-run-start.1 passed", "failures": 0, "unique_id": "operation.dbt_transformation.dbt_transformation-on-run-start-1", "compiled": true, "compiled_code": "\n    COPY INTO STG_EDX_RAW FROM @SKILLPATH_DB.RAW_DATA.EDX_SCRAPED_STAGE FILE_FORMAT = (FORMAT_NAME = SKILLPATH_DB.RAW_DATA.JSON_FORMAT) ON_ERROR = 'CONTINUE';\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T23:02:04.198979Z", "completed_at": "2025-03-25T23:02:04.207539Z"}, {"name": "execute", "started_at": "2025-03-25T23:02:04.208109Z", "completed_at": "2025-03-25T23:02:04.485767Z"}], "thread_id": "main", "execution_time": 0.286788, "adapter_response": {}, "message": "dbt_transformation.on-run-start.2 passed", "failures": 0, "unique_id": "operation.dbt_transformation.dbt_transformation-on-run-start-2", "compiled": true, "compiled_code": "\n    CREATE or REPLACE TABLE SKILLPATH_DB.RAW_DATA.STG_UDACITY_RAW (RAW_CONTENT VARIANT);\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T23:02:04.486933Z", "completed_at": "2025-03-25T23:02:04.499133Z"}, {"name": "execute", "started_at": "2025-03-25T23:02:04.499935Z", "completed_at": "2025-03-25T23:02:06.321208Z"}], "thread_id": "main", "execution_time": 1.834275, "adapter_response": {}, "message": "dbt_transformation.on-run-start.3 passed", "failures": 0, "unique_id": "operation.dbt_transformation.dbt_transformation-on-run-start-3", "compiled": true, "compiled_code": "\n    COPY INTO STG_UDACITY_RAW FROM @SKILLPATH_DB.RAW_DATA.UDACITY_SCRAPED_STAGE FILE_FORMAT = (FORMAT_NAME = SKILLPATH_DB.RAW_DATA.JSON_FORMAT) ON_ERROR = 'CONTINUE';\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T23:02:06.333258Z", "completed_at": "2025-03-25T23:02:06.340864Z"}, {"name": "execute", "started_at": "2025-03-25T23:02:06.341308Z", "completed_at": "2025-03-25T23:02:09.088529Z"}], "thread_id": "Thread-1", "execution_time": 2.7570338249206543, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb40e6-0204-c8b8-0003-d5630032e2ea"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformation.COURSERA_COURSES", "compiled": true, "compiled_code": "\n\n-- This SELECT statement is required by dbt. It simply returns the contents of the table.\nSELECT * FROM COURSERA_COURSES", "relation_name": "SKILLPATH_DB.RAW_DATA.COURSERA_COURSES", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T23:02:09.094029Z", "completed_at": "2025-03-25T23:02:09.098049Z"}, {"name": "execute", "started_at": "2025-03-25T23:02:09.098488Z", "completed_at": "2025-03-25T23:02:11.846064Z"}], "thread_id": "Thread-1", "execution_time": 2.7531659603118896, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb40e6-0204-ccc2-0003-d5630032d4ea"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformation.edx_courses", "compiled": true, "compiled_code": "\n \nSELECT * FROM EDX_COURSES", "relation_name": "SKILLPATH_DB.RAW_DATA.edx_courses", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T23:02:11.852439Z", "completed_at": "2025-03-25T23:02:11.857958Z"}, {"name": "execute", "started_at": "2025-03-25T23:02:11.858478Z", "completed_at": "2025-03-25T23:02:12.092707Z"}], "thread_id": "Thread-1", "execution_time": 0.24161887168884277, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb40e6-0204-c8b8-0003-d5630032e2f2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformation.my_first_dbt_model", "compiled": true, "compiled_code": "/*\n    Welcome to your first dbt model!\n    Did you know that you can also configure models directly within SQL files?\n    This will override configurations stated in dbt_project.yml\n\n    Try changing \"table\" to \"view\" below\n*/\n\n\n\nwith source_data as (\n\n    select 1 as id\n    union all\n    select null as id\n\n)\n\nselect *\nfrom source_data\n\n/*\n    Uncomment the line below to remove records with null `id` values\n*/\n\n-- where id is not null", "relation_name": "SKILLPATH_DB.RAW_DATA.my_first_dbt_model", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T23:02:12.096981Z", "completed_at": "2025-03-25T23:02:12.101758Z"}, {"name": "execute", "started_at": "2025-03-25T23:02:12.102130Z", "completed_at": "2025-03-25T23:02:14.872931Z"}], "thread_id": "Thread-1", "execution_time": 2.777114152908325, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb40e6-0204-ccc2-0003-d5630032d4f2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformation.pluralsight_courses", "compiled": true, "compiled_code": "\n \nSELECT * FROM PLURALSIGHT_COURSES", "relation_name": "SKILLPATH_DB.RAW_DATA.pluralsight_courses", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T23:02:14.880210Z", "completed_at": "2025-03-25T23:02:14.886839Z"}, {"name": "execute", "started_at": "2025-03-25T23:02:14.887392Z", "completed_at": "2025-03-25T23:02:16.378987Z"}], "thread_id": "Thread-1", "execution_time": 1.5003960132598877, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb40e6-0204-c8b8-0003-d5630032e2fa"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformation.stg_edx_courses", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM SKILLPATH_DB.RAW_DATA.STG_EDX_RAW\n),\n\ntransformed AS (\n    SELECT \n        UUID_STRING() AS id,\n        raw_content:URL::STRING AS url,\n        TRIM(raw_content:course_name::STRING) AS course_name,\n        TRIM(\n            REGEXP_REPLACE(\n                REGEXP_REPLACE(\n                    REGEXP_REPLACE(raw_content:course_description::VARCHAR, '\\\\n', ' '),\n                    '\\\\r', ' '\n                ),\n                '\\\\t', ' '\n            )\n        ) AS description,\n        NULLIF(\n            TRIM(\n                CASE \n                    WHEN UPPER(REGEXP_REPLACE(raw_content:prerequisites::STRING, '\\\\.', '')) IN ('NOT FOUND', 'NONE', '') \n                    THEN NULL\n                    ELSE raw_content:prerequisites::STRING\n                END\n            ), \n            ''\n        ) AS prerequisites,\n        CASE \n            WHEN UPPER(REGEXP_REPLACE(raw_content:prerequisites::STRING, '\\\\.', '')) IN ('NOT FOUND', 'NONE', '') \n                 OR raw_content:prerequisites::STRING IS NULL \n            THEN FALSE\n            ELSE TRUE\n        END AS has_prerequisites,\n        NULLIF(\n            REPLACE(raw_content:associated_skills::STRING, 'Not found', ''), \n            ''\n        ) AS skills,\n        NULLIF(\n            TRIM(\n                REGEXP_REPLACE(\n                    REGEXP_REPLACE(\n                        REGEXP_REPLACE(\n                            REPLACE(raw_content:grow_these_skills::STRING, 'Not found', ''),\n                            '\\\\n', ' '\n                        ),\n                        '\\\\r', ' '\n                    ),\n                    '\\\\t', ' '\n                )\n            ),\n            ''\n        ) AS grow_these_skills,\n        TRIM(raw_content:institution::STRING) AS institution,\n        TRIM(raw_content:level::STRING) AS level,\n        CASE\n            WHEN raw_content:language::STRING = 'en' THEN 'ENGLISH'\n            ELSE 'OTHERS'\n        END AS language,\n        TRIM(raw_content:duration::STRING) AS duration,\n        CASE \n            WHEN raw_content:duration::STRING LIKE '%weeks%' THEN \n                REGEXP_SUBSTR(raw_content:duration::STRING, '[0-9]+')::FLOAT * 168  -- Weeks to hours\n            WHEN raw_content:duration::STRING LIKE '%week%' THEN \n                REGEXP_SUBSTR(raw_content:duration::STRING, '[0-9]+')::FLOAT * 168  -- Weeks to hours\n            ELSE NULL\n        END AS duration_hours,\n        COALESCE(\n            TRY_CAST(\n                CASE \n                    WHEN raw_content:rating::STRING = 'Not found' THEN '-1'\n                    ELSE raw_content:rating::STRING \n                END AS FLOAT\n            ), \n            -1\n        ) AS rating,\n        'edX' AS source,\n        CURRENT_TIMESTAMP AS ingestion_time\n    FROM source\n)\n\nSELECT * FROM transformed", "relation_name": "SKILLPATH_DB.RAW_DATA.stg_edx_courses", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T23:02:16.386015Z", "completed_at": "2025-03-25T23:02:16.392622Z"}, {"name": "execute", "started_at": "2025-03-25T23:02:16.393167Z", "completed_at": "2025-03-25T23:02:17.261206Z"}], "thread_id": "Thread-1", "execution_time": 0.8766999244689941, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb40e6-0204-ccc2-0003-d5630032d4f6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformation.stg_udacity_courses", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM SKILLPATH_DB.RAW_DATA.STG_UDACITY_RAW\n),\n\ntransformed AS (\n    SELECT \n        UUID_STRING() AS id,\n        raw_content:URL::STRING AS url,\n        TRIM(raw_content:\"Course Name\"::STRING) AS course_name,\n        TRIM(\n            REGEXP_REPLACE(\n                REGEXP_REPLACE(\n                    REGEXP_REPLACE(raw_content:Description::VARCHAR, '\\\\n', ' '),\n                '\\\\r', ' '\n            ),\n            '\\\\t', ' '\n            )\n        ) AS description,\n        NULLIF(ARRAY_TO_STRING(SPLIT(TRIM(raw_content:Prerequisites::STRING), ','), ', '), '') AS prerequisites,\n        CASE \n            WHEN raw_content:Prerequisites::STRING IS NULL OR raw_content:Prerequisites::STRING = '' THEN FALSE\n            ELSE TRUE\n        END AS has_prerequisites,\n        NULLIF(ARRAY_TO_STRING(SPLIT(TRIM(raw_content:Skills::STRING), ', '), ', '), '') AS skills,\n        TRIM(raw_content:Level::STRING) AS level,\n        CASE\n            WHEN raw_content:Language::STRING LIKE 'en' THEN\n            'ENGLISH'\n            ELSE 'OTHERS'\n         END AS language,\n        CONCAT(\n            REGEXP_SUBSTR(raw_content:Duration::VARCHAR, '[0-9]+'), ' ',\n            CASE \n                WHEN raw_content:Duration::VARCHAR LIKE 'P%M' THEN 'months'\n                WHEN raw_content:Duration::VARCHAR LIKE 'P%W' THEN 'weeks'\n                WHEN raw_content:Duration::VARCHAR LIKE 'PT%H' THEN 'hours'\n                ELSE 'unknown'\n            END\n        ) AS duration,\n        CASE \n            WHEN raw_content:Duration::STRING LIKE 'P%M' THEN \n                REGEXP_SUBSTR(raw_content:Duration::STRING, '[0-9]+')::FLOAT * 730  -- Months to hours\n            WHEN raw_content:Duration::STRING LIKE 'P%W' THEN \n                REGEXP_SUBSTR(raw_content:Duration::STRING, '[0-9]+')::FLOAT * 168  -- Weeks to hours\n            WHEN raw_content:Duration::STRING LIKE 'PT%H' THEN \n                REGEXP_SUBSTR(raw_content:Duration::STRING, '[0-9]+')::FLOAT       -- Hours\n            ELSE NULL\n        END AS duration_hours,\n        COALESCE(TRY_CAST(raw_content:Rating::STRING AS FLOAT),-1) AS rating,\n        'Udacity' AS source,\n        CURRENT_TIMESTAMP AS ingestion_time\n    FROM source\n)\n\nSELECT * FROM transformed", "relation_name": "SKILLPATH_DB.RAW_DATA.stg_udacity_courses", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-03-25T23:02:17.266255Z", "completed_at": "2025-03-25T23:02:17.271468Z"}, {"name": "execute", "started_at": "2025-03-25T23:02:17.271851Z", "completed_at": "2025-03-25T23:02:17.530787Z"}], "thread_id": "Thread-1", "execution_time": 0.26795411109924316, "adapter_response": {}, "message": "Database Error in model udacity_courses (models/table_creation/udacity_courses.sql)\n  000668 (22023): SQL compilation error:\n  Invalid template: template must be a non-null JSON array\n  ", "failures": null, "unique_id": "model.dbt_transformation.udacity_courses", "compiled": true, "compiled_code": "\n \nSELECT * FROM UDACITY_COURSES", "relation_name": "SKILLPATH_DB.RAW_DATA.udacity_courses", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T23:02:17.538135Z", "completed_at": "2025-03-25T23:02:17.542623Z"}, {"name": "execute", "started_at": "2025-03-25T23:02:17.542978Z", "completed_at": "2025-03-25T23:02:34.888697Z"}], "thread_id": "Thread-1", "execution_time": 17.35210609436035, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb40e6-0204-c8b8-0003-d5630032e306"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformation.udemy_courses", "compiled": true, "compiled_code": "\n \nSELECT * FROM UDEMY_COURSES", "relation_name": "SKILLPATH_DB.RAW_DATA.udemy_courses", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T23:02:34.897874Z", "completed_at": "2025-03-25T23:02:34.906327Z"}, {"name": "execute", "started_at": "2025-03-25T23:02:34.906757Z", "completed_at": "2025-03-25T23:02:35.191012Z"}], "thread_id": "Thread-1", "execution_time": 0.2948169708251953, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb40e6-0204-c8b8-0003-d5630032e30a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformation.my_second_dbt_model", "compiled": true, "compiled_code": "-- Use the `ref` function to select from other models\n\nselect *\nfrom SKILLPATH_DB.RAW_DATA.my_first_dbt_model\nwhere id = 1", "relation_name": "SKILLPATH_DB.RAW_DATA.my_second_dbt_model", "batch_results": null}], "elapsed_time": 35.00114607810974, "args": {"empty": false, "cache_selected_only": false, "exclude": [], "partial_parse_file_diff": true, "require_nested_cumulative_type_params": false, "quiet": false, "log_file_max_bytes": 10485760, "print": true, "warn_error_options": {"include": [], "exclude": []}, "require_resource_names_without_spaces": false, "log_format": "default", "strict_mode": false, "write_json": true, "defer": false, "populate_cache": true, "require_batched_execution_for_custom_microbatch_strategy": false, "log_level": "info", "log_level_file": "debug", "invocation_command": "dbt run", "log_path": "/Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/logs", "select": [], "require_explicit_package_overrides_for_builtin_materializations": true, "printer_width": 80, "indirect_selection": "eager", "state_modified_compare_vars": false, "project_dir": "/Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation", "static_parser": true, "vars": {}, "profiles_dir": "/Users/anusreemohanan/.dbt", "source_freshness_run_project_hooks": false, "version_check": true, "partial_parse": true, "require_yaml_configuration_for_mf_time_spines": false, "show_resource_report": false, "log_format_file": "debug", "use_colors_file": true, "use_colors": true, "favor_state": false, "which": "run", "state_modified_compare_more_unrendered_values": false, "skip_nodes_if_on_run_start_fails": false, "send_anonymous_usage_stats": true, "macro_debugging": false, "introspect": true}}