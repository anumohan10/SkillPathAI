[0m17:25:52.617941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106706bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c1430>]}


============================== 17:25:52.624601 | ee9badc8-9905-4b54-9e75-c3bd3005cd7c ==============================
[0m17:25:52.624601 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:25:52.625158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/anusreemohanan/.dbt', 'log_path': '/Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:25:52.637429 [info ] [MainThread]: dbt version: 1.9.3
[0m17:25:52.638054 [info ] [MainThread]: python version: 3.9.1
[0m17:25:52.638480 [info ] [MainThread]: python path: /Users/anusreemohanan/Documents/GitHub/SkillPathAI/venv/bin/python
[0m17:25:52.638826 [info ] [MainThread]: os info: macOS-15.3.2-arm64-arm-64bit
[0m17:25:53.549590 [info ] [MainThread]: Using profiles dir at /Users/anusreemohanan/.dbt
[0m17:25:53.550079 [info ] [MainThread]: Using profiles.yml file at /Users/anusreemohanan/.dbt/profiles.yml
[0m17:25:53.550405 [info ] [MainThread]: Using dbt_project.yml file at /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/dbt_project.yml
[0m17:25:53.551070 [info ] [MainThread]: adapter type: snowflake
[0m17:25:53.551433 [info ] [MainThread]: adapter version: 1.9.2
[0m17:25:53.643149 [info ] [MainThread]: Configuration:
[0m17:25:53.643681 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:25:53.644007 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:25:53.644398 [info ] [MainThread]: Required dependencies:
[0m17:25:53.644835 [debug] [MainThread]: Executing "git --help"
[0m17:25:53.712605 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:25:53.713522 [debug] [MainThread]: STDERR: "b''"
[0m17:25:53.713922 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:25:53.714272 [info ] [MainThread]: Connection:
[0m17:25:53.714657 [info ] [MainThread]:   account: sfedu02-pdb57018
[0m17:25:53.714935 [info ] [MainThread]:   user: DRAGON
[0m17:25:53.715209 [info ] [MainThread]:   database: SKILLPATH_DB
[0m17:25:53.715476 [info ] [MainThread]:   warehouse: SKILLPATH_WH
[0m17:25:53.715740 [info ] [MainThread]:   role: None
[0m17:25:53.716013 [info ] [MainThread]:   schema: RAW_DATA
[0m17:25:53.716415 [info ] [MainThread]:   authenticator: None
[0m17:25:53.716688 [info ] [MainThread]:   oauth_client_id: None
[0m17:25:53.716957 [info ] [MainThread]:   query_tag: None
[0m17:25:53.717217 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:25:53.717483 [info ] [MainThread]:   host: None
[0m17:25:53.717749 [info ] [MainThread]:   port: None
[0m17:25:53.718020 [info ] [MainThread]:   proxy_host: None
[0m17:25:53.718281 [info ] [MainThread]:   proxy_port: None
[0m17:25:53.718552 [info ] [MainThread]:   protocol: None
[0m17:25:53.719399 [info ] [MainThread]:   connect_retries: 1
[0m17:25:53.719724 [info ] [MainThread]:   connect_timeout: None
[0m17:25:53.720008 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:25:53.720363 [info ] [MainThread]:   retry_all: False
[0m17:25:53.720739 [info ] [MainThread]:   insecure_mode: False
[0m17:25:53.721351 [info ] [MainThread]:   reuse_connections: True
[0m17:25:53.722345 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:25:53.886470 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:25:53.937053 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:25:53.937443 [debug] [MainThread]: On debug: select 1 as id
[0m17:25:53.937752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:54.704410 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.766 seconds
[0m17:25:54.705848 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:25:54.706247 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:25:54.708845 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.1742985, "process_in_blocks": "0", "process_kernel_time": 0.411813, "process_mem_max_rss": "178634752", "process_out_blocks": "0", "process_user_time": 1.899823}
[0m17:25:54.709375 [debug] [MainThread]: Command `dbt debug` succeeded at 17:25:54.709266 after 2.17 seconds
[0m17:25:54.709725 [debug] [MainThread]: Connection 'debug' was left open.
[0m17:25:54.710021 [debug] [MainThread]: On debug: Close
[0m17:25:54.948595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106706bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc0efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc0eee0>]}
[0m17:25:54.949806 [debug] [MainThread]: Flushing usage events
[0m17:25:55.085983 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:35:06.404887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d7b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120972a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120972be0>]}


============================== 17:35:06.409201 | 3b1f7846-f5c1-44b1-a1ed-0e570aca7d2f ==============================
[0m17:35:06.409201 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:35:06.409804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/anusreemohanan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:35:07.369409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b1f7846-f5c1-44b1-a1ed-0e570aca7d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120950a00>]}
[0m17:35:07.420528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b1f7846-f5c1-44b1-a1ed-0e570aca7d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13021af70>]}
[0m17:35:07.423815 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:35:07.581805 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:35:07.582631 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:35:07.583007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3b1f7846-f5c1-44b1-a1ed-0e570aca7d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130277ee0>]}
[0m17:35:07.626237 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two macros named "copy_to_stg_udacity_raw" in the project
  "dbt_transformation".
   To fix this error, rename or remove one of the following macros:
      - macros/stage_edx_scraped.sql
      - macros/stage_udacity_scraped.sql
[0m17:35:07.628525 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2882749, "process_in_blocks": "0", "process_kernel_time": 0.362135, "process_mem_max_rss": "169705472", "process_out_blocks": "0", "process_user_time": 1.85204}
[0m17:35:07.628986 [debug] [MainThread]: Command `dbt run` failed at 17:35:07.628885 after 1.29 seconds
[0m17:35:07.629352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d7b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1305cf8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1305cfaf0>]}
[0m17:35:07.629714 [debug] [MainThread]: Flushing usage events
[0m17:35:07.789746 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:37:42.259991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105204c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a42b0>]}


============================== 17:37:42.264424 | aab60617-2064-471c-b876-ab8795205204 ==============================
[0m17:37:42.264424 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:37:42.265034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/logs', 'profiles_dir': '/Users/anusreemohanan/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:37:43.242845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aab60617-2064-471c-b876-ab8795205204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040e5280>]}
[0m17:37:43.294869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aab60617-2064-471c-b876-ab8795205204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1357f0>]}
[0m17:37:43.296319 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:37:43.454180 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:37:43.454976 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:37:43.455376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aab60617-2064-471c-b876-ab8795205204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1901c0>]}
[0m17:37:44.902265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aab60617-2064-471c-b876-ab8795205204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9c5e50>]}
[0m17:37:45.018654 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/manifest.json
[0m17:37:45.020027 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/semantic_manifest.json
[0m17:37:45.035425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aab60617-2064-471c-b876-ab8795205204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9b3e50>]}
[0m17:37:45.035908 [info ] [MainThread]: Found 8 models, 2 operations, 4 data tests, 1 source, 479 macros
[0m17:37:45.036245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aab60617-2064-471c-b876-ab8795205204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046292e0>]}
[0m17:37:45.037757 [info ] [MainThread]: 
[0m17:37:45.038098 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:37:45.038379 [info ] [MainThread]: 
[0m17:37:45.038816 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:37:45.044211 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SKILLPATH_DB'
[0m17:37:45.155969 [debug] [ThreadPool]: Using snowflake connection "list_SKILLPATH_DB"
[0m17:37:45.156427 [debug] [ThreadPool]: On list_SKILLPATH_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "list_SKILLPATH_DB"} */
show terse schemas in database SKILLPATH_DB
    limit 10000
[0m17:37:45.156875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:46.093623 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.937 seconds
[0m17:37:46.097569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SKILLPATH_DB, now list_SKILLPATH_DB_RAW_DATA)
[0m17:37:46.110474 [debug] [ThreadPool]: Using snowflake connection "list_SKILLPATH_DB_RAW_DATA"
[0m17:37:46.110918 [debug] [ThreadPool]: On list_SKILLPATH_DB_RAW_DATA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "list_SKILLPATH_DB_RAW_DATA"} */
show objects in SKILLPATH_DB.RAW_DATA limit 10000;
[0m17:37:46.280788 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.169 seconds
[0m17:37:46.284560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aab60617-2064-471c-b876-ab8795205204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b676880>]}
[0m17:37:46.292696 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_transformation.dbt_transformation-on-run-start-0"
[0m17:37:46.296351 [info ] [MainThread]: 1 of 2 START hook: dbt_transformation.on-run-start.0 ........................... [RUN]
[0m17:37:46.296972 [debug] [MainThread]: Using snowflake connection "master"
[0m17:37:46.297327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "master"} */
CREATE or REPLACE TABLE SKILLPATH_DB.RAW_DATA.STG_EDX_RAW (RAW_CONTENT VARIANT);
[0m17:37:46.297656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:37:47.181314 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.883 seconds
[0m17:37:47.183787 [info ] [MainThread]: 1 of 2 OK hook: dbt_transformation.on-run-start.0 .............................. [[32mOK[0m in 0.90s]
[0m17:37:47.192507 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_transformation.dbt_transformation-on-run-start-1"
[0m17:37:47.194433 [info ] [MainThread]: 2 of 2 START hook: dbt_transformation.on-run-start.1 ........................... [RUN]
[0m17:37:47.195570 [debug] [MainThread]: Using snowflake connection "master"
[0m17:37:47.196198 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "master"} */
COPY INTO STG_EDX_RAW FROM @SKILLPATH_DB.RAW_DATA.EDX_SCRAPED_STAGE FILE_FORMAT = (FORMAT_NAME = SKILLPATH_DB.RAW_DATA.JSON_FORMAT) ON_ERROR = 'CONTINUE';
[0m17:37:49.603278 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.406 seconds
[0m17:37:49.606410 [info ] [MainThread]: 2 of 2 OK hook: dbt_transformation.on-run-start.1 .............................. [[32mOK[0m in 2.42s]
[0m17:37:49.607365 [info ] [MainThread]: 
[0m17:37:49.611903 [debug] [Thread-1  ]: Began running node model.dbt_transformation.COURSERA_COURSES
[0m17:37:49.612814 [info ] [Thread-1  ]: 1 of 8 START sql table model RAW_DATA.COURSERA_COURSES ......................... [RUN]
[0m17:37:49.613672 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_SKILLPATH_DB_RAW_DATA, now model.dbt_transformation.COURSERA_COURSES)
[0m17:37:49.614363 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.COURSERA_COURSES
[0m17:37:49.619071 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.COURSERA_COURSES"
[0m17:37:49.620786 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.COURSERA_COURSES
[0m17:37:49.638547 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.COURSERA_COURSES"
[0m17:37:49.639011 [debug] [Thread-1  ]: On model.dbt_transformation.COURSERA_COURSES: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.COURSERA_COURSES"} */
CREATE OR REPLACE TABLE COURSERA_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@COURSERA_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m17:37:50.540729 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.901 seconds
[0m17:37:50.544519 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.COURSERA_COURSES"
[0m17:37:50.545346 [debug] [Thread-1  ]: On model.dbt_transformation.COURSERA_COURSES: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.COURSERA_COURSES"} */
COPY INTO COURSERA_COURSES FROM @COURSERA_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m17:37:51.318707 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.773 seconds
[0m17:37:51.334847 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.COURSERA_COURSES"
[0m17:37:51.336144 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.COURSERA_COURSES"
[0m17:37:51.336533 [debug] [Thread-1  ]: On model.dbt_transformation.COURSERA_COURSES: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.COURSERA_COURSES"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.COURSERA_COURSES
         as
        (

-- This SELECT statement is required by dbt. It simply returns the contents of the table.
SELECT * FROM COURSERA_COURSES
        );
[0m17:37:52.158701 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.822 seconds
[0m17:37:52.195129 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aab60617-2064-471c-b876-ab8795205204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e93eb0>]}
[0m17:37:52.195994 [info ] [Thread-1  ]: 1 of 8 OK created sql table model RAW_DATA.COURSERA_COURSES .................... [[32mSUCCESS 1[0m in 2.58s]
[0m17:37:52.196589 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.COURSERA_COURSES
[0m17:37:52.196998 [debug] [Thread-1  ]: Began running node model.dbt_transformation.edx_courses
[0m17:37:52.197518 [info ] [Thread-1  ]: 2 of 8 START sql table model RAW_DATA.edx_courses .............................. [RUN]
[0m17:37:52.197967 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.COURSERA_COURSES, now model.dbt_transformation.edx_courses)
[0m17:37:52.198317 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.edx_courses
[0m17:37:52.201601 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.edx_courses"
[0m17:37:52.202425 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.edx_courses
[0m17:37:52.205485 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.edx_courses"
[0m17:37:52.205887 [debug] [Thread-1  ]: On model.dbt_transformation.edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.edx_courses"} */
CREATE OR REPLACE TABLE EDX_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@EDX_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m17:37:52.877483 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.671 seconds
[0m17:37:52.879999 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.edx_courses"
[0m17:37:52.880666 [debug] [Thread-1  ]: On model.dbt_transformation.edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.edx_courses"} */
COPY INTO EDX_COURSES FROM @EDX_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m17:37:54.621060 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.739 seconds
[0m17:37:54.625536 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.edx_courses"
[0m17:37:54.627870 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.edx_courses"
[0m17:37:54.628562 [debug] [Thread-1  ]: On model.dbt_transformation.edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.edx_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.edx_courses
         as
        (
 
SELECT * FROM EDX_COURSES
        );
[0m17:37:55.439624 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.810 seconds
[0m17:37:55.447577 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aab60617-2064-471c-b876-ab8795205204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1b80a0>]}
[0m17:37:55.449024 [info ] [Thread-1  ]: 2 of 8 OK created sql table model RAW_DATA.edx_courses ......................... [[32mSUCCESS 1[0m in 3.25s]
[0m17:37:55.449977 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.edx_courses
[0m17:37:55.450640 [debug] [Thread-1  ]: Began running node model.dbt_transformation.my_first_dbt_model
[0m17:37:55.451566 [info ] [Thread-1  ]: 3 of 8 START sql view model RAW_DATA.my_first_dbt_model ........................ [RUN]
[0m17:37:55.452436 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.edx_courses, now model.dbt_transformation.my_first_dbt_model)
[0m17:37:55.453058 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.my_first_dbt_model
[0m17:37:55.462938 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.my_first_dbt_model"
[0m17:37:55.464106 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.my_first_dbt_model
[0m17:37:55.486275 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.my_first_dbt_model"
[0m17:37:55.487492 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.my_first_dbt_model"
[0m17:37:55.487894 [debug] [Thread-1  ]: On model.dbt_transformation.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.my_first_dbt_model"} */
create or replace   view SKILLPATH_DB.RAW_DATA.my_first_dbt_model
  
   as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:37:55.702532 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.213 seconds
[0m17:37:55.707109 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aab60617-2064-471c-b876-ab8795205204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f28dee0>]}
[0m17:37:55.708127 [info ] [Thread-1  ]: 3 of 8 OK created sql view model RAW_DATA.my_first_dbt_model ................... [[32mSUCCESS 1[0m in 0.25s]
[0m17:37:55.708901 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.my_first_dbt_model
[0m17:37:55.709449 [debug] [Thread-1  ]: Began running node model.dbt_transformation.pluralsight_courses
[0m17:37:55.710254 [info ] [Thread-1  ]: 4 of 8 START sql table model RAW_DATA.pluralsight_courses ...................... [RUN]
[0m17:37:55.711022 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.my_first_dbt_model, now model.dbt_transformation.pluralsight_courses)
[0m17:37:55.711433 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.pluralsight_courses
[0m17:37:55.717493 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.pluralsight_courses"
[0m17:37:55.718445 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.pluralsight_courses
[0m17:37:55.721775 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.pluralsight_courses"
[0m17:37:55.722264 [debug] [Thread-1  ]: On model.dbt_transformation.pluralsight_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.pluralsight_courses"} */
CREATE OR REPLACE TABLE PLURALSIGHT_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@PLURALSIGHT_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m17:37:56.207196 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.484 seconds
[0m17:37:56.210920 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.pluralsight_courses"
[0m17:37:56.211759 [debug] [Thread-1  ]: On model.dbt_transformation.pluralsight_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.pluralsight_courses"} */
COPY INTO PLURALSIGHT_COURSES FROM @PLURALSIGHT_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m17:37:56.953516 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.741 seconds
[0m17:37:56.955568 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.pluralsight_courses"
[0m17:37:56.956923 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.pluralsight_courses"
[0m17:37:56.957376 [debug] [Thread-1  ]: On model.dbt_transformation.pluralsight_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.pluralsight_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.pluralsight_courses
         as
        (
 
SELECT * FROM PLURALSIGHT_COURSES
        );
[0m17:37:57.729169 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.771 seconds
[0m17:37:57.735867 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aab60617-2064-471c-b876-ab8795205204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b603a00>]}
[0m17:37:57.737601 [info ] [Thread-1  ]: 4 of 8 OK created sql table model RAW_DATA.pluralsight_courses ................. [[32mSUCCESS 1[0m in 2.02s]
[0m17:37:57.738584 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.pluralsight_courses
[0m17:37:57.739237 [debug] [Thread-1  ]: Began running node model.dbt_transformation.stg_udacity_courses
[0m17:37:57.740888 [info ] [Thread-1  ]: 5 of 8 START sql table model RAW_DATA.stg_udacity_courses ...................... [RUN]
[0m17:37:57.741815 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.pluralsight_courses, now model.dbt_transformation.stg_udacity_courses)
[0m17:37:57.742546 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.stg_udacity_courses
[0m17:37:57.749548 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.stg_udacity_courses"
[0m17:37:57.751180 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.stg_udacity_courses
[0m17:37:57.756513 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.stg_udacity_courses"
[0m17:37:57.760144 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.stg_udacity_courses"
[0m17:37:57.760731 [debug] [Thread-1  ]: On model.dbt_transformation.stg_udacity_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.stg_udacity_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.stg_udacity_courses
         as
        (WITH source AS (
    SELECT * FROM SKILLPATH_DB.RAW_DATA.STG_UDACITY_RAW
),

transformed AS (
    SELECT 
        UUID_STRING() AS id,
        raw_content:URL::STRING AS url,
        TRIM(raw_content:"Course Name"::STRING) AS course_name,
        TRIM(
            REGEXP_REPLACE(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(raw_content:Description::VARCHAR, '\\n', ' '),
                '\\r', ' '
            ),
            '\\t', ' '
            )
        ) AS description,
        NULLIF(ARRAY_TO_STRING(SPLIT(TRIM(raw_content:Prerequisites::STRING), ','), ', '), '') AS prerequisites,
        CASE 
            WHEN raw_content:Prerequisites::STRING IS NULL OR raw_content:Prerequisites::STRING = '' THEN FALSE
            ELSE TRUE
        END AS has_prerequisites,
        NULLIF(ARRAY_TO_STRING(SPLIT(TRIM(raw_content:Skills::STRING), ', '), ', '), '') AS skills,
        TRIM(raw_content:Level::STRING) AS level,
        CASE
            WHEN raw_content:Language::STRING LIKE 'en' THEN
            'ENGLISH'
            ELSE 'OTHERS'
         END AS language,
        CONCAT(
            REGEXP_SUBSTR(raw_content:Duration::VARCHAR, '[0-9]+'), ' ',
            CASE 
                WHEN raw_content:Duration::VARCHAR LIKE 'P%M' THEN 'months'
                WHEN raw_content:Duration::VARCHAR LIKE 'P%W' THEN 'weeks'
                WHEN raw_content:Duration::VARCHAR LIKE 'PT%H' THEN 'hours'
                ELSE 'unknown'
            END
        ) AS duration,
        CASE 
            WHEN raw_content:Duration::STRING LIKE 'P%M' THEN 
                REGEXP_SUBSTR(raw_content:Duration::STRING, '[0-9]+')::FLOAT * 730  -- Months to hours
            WHEN raw_content:Duration::STRING LIKE 'P%W' THEN 
                REGEXP_SUBSTR(raw_content:Duration::STRING, '[0-9]+')::FLOAT * 168  -- Weeks to hours
            WHEN raw_content:Duration::STRING LIKE 'PT%H' THEN 
                REGEXP_SUBSTR(raw_content:Duration::STRING, '[0-9]+')::FLOAT       -- Hours
            ELSE NULL
        END AS duration_hours,
        COALESCE(TRY_CAST(raw_content:Rating::STRING AS FLOAT),-1) AS rating,
        'Udacity' AS source,
        CURRENT_TIMESTAMP AS ingestion_time
    FROM source
)

SELECT * FROM transformed
        );
[0m17:37:59.021573 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.260 seconds
[0m17:37:59.024169 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aab60617-2064-471c-b876-ab8795205204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f261f70>]}
[0m17:37:59.025006 [info ] [Thread-1  ]: 5 of 8 OK created sql table model RAW_DATA.stg_udacity_courses ................. [[32mSUCCESS 1[0m in 1.28s]
[0m17:37:59.025720 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.stg_udacity_courses
[0m17:37:59.026180 [debug] [Thread-1  ]: Began running node model.dbt_transformation.udacity_courses
[0m17:37:59.026771 [info ] [Thread-1  ]: 6 of 8 START sql table model RAW_DATA.udacity_courses .......................... [RUN]
[0m17:37:59.027329 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.stg_udacity_courses, now model.dbt_transformation.udacity_courses)
[0m17:37:59.027750 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.udacity_courses
[0m17:37:59.031467 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.udacity_courses"
[0m17:37:59.032382 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.udacity_courses
[0m17:37:59.037282 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udacity_courses"
[0m17:37:59.037801 [debug] [Thread-1  ]: On model.dbt_transformation.udacity_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udacity_courses"} */
CREATE OR REPLACE TABLE UDACITY_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@UDACITY_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m17:37:59.288492 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01bb4091-0204-c8b8-0003-d5630032c9c2
[0m17:37:59.289370 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000668 (22023): SQL compilation error:
Invalid template: template must be a non-null JSON array

[0m17:37:59.292423 [debug] [Thread-1  ]: Database Error in model udacity_courses (models/table_creation/udacity_courses.sql)
  000668 (22023): SQL compilation error:
  Invalid template: template must be a non-null JSON array
  
[0m17:37:59.293726 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aab60617-2064-471c-b876-ab8795205204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2a59d0>]}
[0m17:37:59.294772 [error] [Thread-1  ]: 6 of 8 ERROR creating sql table model RAW_DATA.udacity_courses ................. [[31mERROR[0m in 0.27s]
[0m17:37:59.295647 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.udacity_courses
[0m17:37:59.296263 [debug] [Thread-1  ]: Began running node model.dbt_transformation.udemy_courses
[0m17:37:59.297041 [debug] [Thread-4  ]: Marking all children of 'model.dbt_transformation.udacity_courses' to be skipped because of status 'error'.  Reason: Database Error in model udacity_courses (models/table_creation/udacity_courses.sql)
  000668 (22023): SQL compilation error:
  Invalid template: template must be a non-null JSON array
  .
[0m17:37:59.297754 [info ] [Thread-1  ]: 7 of 8 START sql table model RAW_DATA.udemy_courses ............................ [RUN]
[0m17:37:59.298649 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.udacity_courses, now model.dbt_transformation.udemy_courses)
[0m17:37:59.299140 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.udemy_courses
[0m17:37:59.303788 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.udemy_courses"
[0m17:37:59.304844 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.udemy_courses
[0m17:37:59.308721 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udemy_courses"
[0m17:37:59.309211 [debug] [Thread-1  ]: On model.dbt_transformation.udemy_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udemy_courses"} */
CREATE OR REPLACE TABLE UDEMY_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@UDEMY_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m17:38:06.299883 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 6.988 seconds
[0m17:38:06.306651 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udemy_courses"
[0m17:38:06.307234 [debug] [Thread-1  ]: On model.dbt_transformation.udemy_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udemy_courses"} */
COPY INTO UDEMY_COURSES FROM @UDEMY_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m17:38:11.836618 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5.529 seconds
[0m17:38:11.842448 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.udemy_courses"
[0m17:38:11.845485 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udemy_courses"
[0m17:38:11.846123 [debug] [Thread-1  ]: On model.dbt_transformation.udemy_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udemy_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.udemy_courses
         as
        (
 
SELECT * FROM UDEMY_COURSES
        );
[0m17:38:15.218754 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.371 seconds
[0m17:38:15.228302 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aab60617-2064-471c-b876-ab8795205204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b539370>]}
[0m17:38:15.229507 [info ] [Thread-1  ]: 7 of 8 OK created sql table model RAW_DATA.udemy_courses ....................... [[32mSUCCESS 1[0m in 15.93s]
[0m17:38:15.230187 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.udemy_courses
[0m17:38:15.230676 [debug] [Thread-1  ]: Began running node model.dbt_transformation.my_second_dbt_model
[0m17:38:15.231479 [info ] [Thread-1  ]: 8 of 8 START sql view model RAW_DATA.my_second_dbt_model ....................... [RUN]
[0m17:38:15.232097 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.udemy_courses, now model.dbt_transformation.my_second_dbt_model)
[0m17:38:15.232505 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.my_second_dbt_model
[0m17:38:15.244971 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.my_second_dbt_model"
[0m17:38:15.246564 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.my_second_dbt_model
[0m17:38:15.252716 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.my_second_dbt_model"
[0m17:38:15.254685 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.my_second_dbt_model"
[0m17:38:15.255754 [debug] [Thread-1  ]: On model.dbt_transformation.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.my_second_dbt_model"} */
create or replace   view SKILLPATH_DB.RAW_DATA.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from SKILLPATH_DB.RAW_DATA.my_first_dbt_model
where id = 1
  );
[0m17:38:15.716747 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.460 seconds
[0m17:38:16.067399 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aab60617-2064-471c-b876-ab8795205204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3c3970>]}
[0m17:38:16.074540 [info ] [Thread-1  ]: 8 of 8 OK created sql view model RAW_DATA.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.69s]
[0m17:38:16.085068 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.my_second_dbt_model
[0m17:38:16.264126 [debug] [MainThread]: Connection 'master' was left open.
[0m17:38:16.265643 [debug] [MainThread]: On master: Close
[0m17:38:16.535836 [debug] [MainThread]: Connection 'model.dbt_transformation.my_second_dbt_model' was left open.
[0m17:38:16.536388 [debug] [MainThread]: On model.dbt_transformation.my_second_dbt_model: Close
[0m17:38:16.771069 [info ] [MainThread]: 
[0m17:38:16.771972 [info ] [MainThread]: Finished running 2 project hooks, 6 table models, 2 view models in 0 hours 0 minutes and 31.73 seconds (31.73s).
[0m17:38:16.775675 [debug] [MainThread]: Command end result
[0m17:38:16.809290 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/manifest.json
[0m17:38:16.813692 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/semantic_manifest.json
[0m17:38:16.821277 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/run_results.json
[0m17:38:16.821656 [info ] [MainThread]: 
[0m17:38:16.822061 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:38:16.822445 [info ] [MainThread]: 
[0m17:38:16.822864 [error] [MainThread]:   Database Error in model udacity_courses (models/table_creation/udacity_courses.sql)
  000668 (22023): SQL compilation error:
  Invalid template: template must be a non-null JSON array
  
[0m17:38:16.823196 [info ] [MainThread]: 
[0m17:38:16.824276 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m17:38:16.840243 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 34.645897, "process_in_blocks": "0", "process_kernel_time": 0.562346, "process_mem_max_rss": "192692224", "process_out_blocks": "0", "process_user_time": 4.075112}
[0m17:38:16.840849 [debug] [MainThread]: Command `dbt run` failed at 17:38:16.840761 after 34.65 seconds
[0m17:38:16.841346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105204c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d817f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba7f940>]}
[0m17:38:16.841737 [debug] [MainThread]: Flushing usage events
[0m17:38:16.980599 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:23.093557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105653b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f94f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f9310>]}


============================== 18:00:23.098166 | 9468f838-7e6b-4f0a-a7ee-8d8f8786f6d0 ==============================
[0m18:00:23.098166 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:00:23.098753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/logs', 'debug': 'False', 'profiles_dir': '/Users/anusreemohanan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:23.224876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9468f838-7e6b-4f0a-a7ee-8d8f8786f6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d8370>]}
[0m18:00:23.244204 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21674383, "process_in_blocks": "0", "process_kernel_time": 0.142106, "process_mem_max_rss": "95617024", "process_out_blocks": "0", "process_user_time": 1.237343}
[0m18:00:23.244702 [debug] [MainThread]: Command `dbt clean` succeeded at 18:00:23.244604 after 0.22 seconds
[0m18:00:23.245066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105653b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10656c8b0>]}
[0m18:00:23.245430 [debug] [MainThread]: Flushing usage events
[0m18:00:23.401231 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:33:57.094738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb7b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb7d60>]}


============================== 18:33:57.100052 | 6ba92d64-8e92-49c0-9c22-32b3e3621537 ==============================
[0m18:33:57.100052 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:33:57.100640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/anusreemohanan/.dbt', 'log_path': '/Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:33:58.089560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ba92d64-8e92-49c0-9c22-32b3e3621537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc48280>]}
[0m18:33:58.141274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ba92d64-8e92-49c0-9c22-32b3e3621537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc3f160>]}
[0m18:33:58.142095 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:33:58.297703 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:33:58.298510 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:33:58.298889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6ba92d64-8e92-49c0-9c22-32b3e3621537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc53070>]}
[0m18:33:59.649748 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_transformation.stg_edx_courses' (models/staging/stg_edx_courses.sql) depends on a source named 'RAW_DATA.STG_EDX_RAW' which was not found
[0m18:33:59.653161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6270068, "process_in_blocks": "0", "process_kernel_time": 0.376867, "process_mem_max_rss": "185417728", "process_out_blocks": "0", "process_user_time": 3.157919}
[0m18:33:59.653612 [debug] [MainThread]: Command `dbt run` failed at 18:33:59.653526 after 2.63 seconds
[0m18:33:59.653983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e26be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e27a100>]}
[0m18:33:59.654365 [debug] [MainThread]: Flushing usage events
[0m18:33:59.786310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:38:41.498760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e79430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e79250>]}


============================== 18:38:41.504404 | 694d1227-ccd6-4688-af1f-95fd7344e16a ==============================
[0m18:38:41.504404 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:38:41.505027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/logs', 'profiles_dir': '/Users/anusreemohanan/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:38:41.517572 [info ] [MainThread]: dbt version: 1.9.3
[0m18:38:41.518127 [info ] [MainThread]: python version: 3.9.1
[0m18:38:41.518530 [info ] [MainThread]: python path: /Users/anusreemohanan/Documents/GitHub/SkillPathAI/venv/bin/python
[0m18:38:41.518882 [info ] [MainThread]: os info: macOS-15.3.2-arm64-arm-64bit
[0m18:38:42.420765 [info ] [MainThread]: Using profiles dir at /Users/anusreemohanan/.dbt
[0m18:38:42.421263 [info ] [MainThread]: Using profiles.yml file at /Users/anusreemohanan/.dbt/profiles.yml
[0m18:38:42.421641 [info ] [MainThread]: Using dbt_project.yml file at /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/dbt_project.yml
[0m18:38:42.422193 [info ] [MainThread]: adapter type: snowflake
[0m18:38:42.422511 [info ] [MainThread]: adapter version: 1.9.2
[0m18:38:42.514921 [info ] [MainThread]: Configuration:
[0m18:38:42.515385 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:38:42.515692 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:38:42.515982 [info ] [MainThread]: Required dependencies:
[0m18:38:42.516350 [debug] [MainThread]: Executing "git --help"
[0m18:38:42.577189 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:38:42.578115 [debug] [MainThread]: STDERR: "b''"
[0m18:38:42.578491 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:38:42.578897 [info ] [MainThread]: Connection:
[0m18:38:42.579384 [info ] [MainThread]:   account: sfedu02-pdb57018
[0m18:38:42.579749 [info ] [MainThread]:   user: DRAGON
[0m18:38:42.580107 [info ] [MainThread]:   database: SKILLPATH_DB
[0m18:38:42.580478 [info ] [MainThread]:   warehouse: SKILLPATH_WH
[0m18:38:42.580838 [info ] [MainThread]:   role: None
[0m18:38:42.581217 [info ] [MainThread]:   schema: RAW_DATA
[0m18:38:42.581582 [info ] [MainThread]:   authenticator: None
[0m18:38:42.581873 [info ] [MainThread]:   oauth_client_id: None
[0m18:38:42.582144 [info ] [MainThread]:   query_tag: None
[0m18:38:42.582440 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:38:42.582713 [info ] [MainThread]:   host: None
[0m18:38:42.582997 [info ] [MainThread]:   port: None
[0m18:38:42.583265 [info ] [MainThread]:   proxy_host: None
[0m18:38:42.583558 [info ] [MainThread]:   proxy_port: None
[0m18:38:42.584070 [info ] [MainThread]:   protocol: None
[0m18:38:42.584422 [info ] [MainThread]:   connect_retries: 1
[0m18:38:42.584716 [info ] [MainThread]:   connect_timeout: None
[0m18:38:42.585002 [info ] [MainThread]:   retry_on_database_errors: False
[0m18:38:42.585282 [info ] [MainThread]:   retry_all: False
[0m18:38:42.585573 [info ] [MainThread]:   insecure_mode: False
[0m18:38:42.585841 [info ] [MainThread]:   reuse_connections: True
[0m18:38:42.586543 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:38:42.739285 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:38:42.788642 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:38:42.789057 [debug] [MainThread]: On debug: select 1 as id
[0m18:38:42.789366 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:38:43.610197 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.821 seconds
[0m18:38:43.611312 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:38:43.611751 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:38:43.614790 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.1824667, "process_in_blocks": "0", "process_kernel_time": 0.483621, "process_mem_max_rss": "184942592", "process_out_blocks": "0", "process_user_time": 2.031481}
[0m18:38:43.615350 [debug] [MainThread]: Command `dbt debug` succeeded at 18:38:43.615234 after 2.18 seconds
[0m18:38:43.615754 [debug] [MainThread]: Connection 'debug' was left open.
[0m18:38:43.616115 [debug] [MainThread]: On debug: Close
[0m18:38:43.855395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4aaeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4aaf40>]}
[0m18:38:43.857066 [debug] [MainThread]: Flushing usage events
[0m18:38:43.992429 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:39:08.419593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121405b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122db7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122db7250>]}


============================== 18:39:08.423920 | deacec09-b82d-49a2-ab35-f8a2be9bfa77 ==============================
[0m18:39:08.423920 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:39:08.424497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/anusreemohanan/.dbt', 'log_path': '/Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:39:09.355842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'deacec09-b82d-49a2-ab35-f8a2be9bfa77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e48fa0>]}
[0m18:39:09.416199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'deacec09-b82d-49a2-ab35-f8a2be9bfa77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133986f70>]}
[0m18:39:09.417370 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:39:09.575102 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:39:09.575890 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:39:09.576272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'deacec09-b82d-49a2-ab35-f8a2be9bfa77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1339d69d0>]}
[0m18:39:10.980572 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_transformation.stg_edx_courses' (models/staging/stg_edx_courses.sql) depends on a source named 'RAW_DATA.STG_EDX_RAW' which was not found
[0m18:39:10.983326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6268039, "process_in_blocks": "0", "process_kernel_time": 0.370909, "process_mem_max_rss": "179486720", "process_out_blocks": "0", "process_user_time": 3.198227}
[0m18:39:10.983865 [debug] [MainThread]: Command `dbt run` failed at 18:39:10.983762 after 2.63 seconds
[0m18:39:10.984311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121405b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13419da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1342590a0>]}
[0m18:39:10.984746 [debug] [MainThread]: Flushing usage events
[0m18:39:11.068575 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:40.275445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110216b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123b4430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123b4250>]}


============================== 18:41:40.280516 | 49ed2f6d-7414-4eb8-813e-1c063ee3a01b ==============================
[0m18:41:40.280516 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:41:40.281121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/anusreemohanan/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:41:41.276823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49ed2f6d-7414-4eb8-813e-1c063ee3a01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111646fa0>]}
[0m18:41:41.328194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49ed2f6d-7414-4eb8-813e-1c063ee3a01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117706f70>]}
[0m18:41:41.329847 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:41:41.488485 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:41:41.489279 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:41:41.489665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '49ed2f6d-7414-4eb8-813e-1c063ee3a01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177569d0>]}
[0m18:41:42.952358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49ed2f6d-7414-4eb8-813e-1c063ee3a01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12019afa0>]}
[0m18:41:43.114740 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/manifest.json
[0m18:41:43.116252 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/semantic_manifest.json
[0m18:41:43.131335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49ed2f6d-7414-4eb8-813e-1c063ee3a01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201db310>]}
[0m18:41:43.131854 [info ] [MainThread]: Found 9 models, 4 operations, 4 data tests, 2 sources, 479 macros
[0m18:41:43.132203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49ed2f6d-7414-4eb8-813e-1c063ee3a01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201a03d0>]}
[0m18:41:43.133781 [info ] [MainThread]: 
[0m18:41:43.134135 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:43.134429 [info ] [MainThread]: 
[0m18:41:43.134873 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:41:43.140156 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SKILLPATH_DB'
[0m18:41:43.202905 [debug] [ThreadPool]: Using snowflake connection "list_SKILLPATH_DB"
[0m18:41:43.203325 [debug] [ThreadPool]: On list_SKILLPATH_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "list_SKILLPATH_DB"} */
show terse schemas in database SKILLPATH_DB
    limit 10000
[0m18:41:43.203653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:44.367763 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.164 seconds
[0m18:41:44.370578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SKILLPATH_DB, now list_SKILLPATH_DB_RAW_DATA)
[0m18:41:44.380846 [debug] [ThreadPool]: Using snowflake connection "list_SKILLPATH_DB_RAW_DATA"
[0m18:41:44.381243 [debug] [ThreadPool]: On list_SKILLPATH_DB_RAW_DATA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "list_SKILLPATH_DB_RAW_DATA"} */
show objects in SKILLPATH_DB.RAW_DATA limit 10000;
[0m18:41:44.554885 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.173 seconds
[0m18:41:44.561485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49ed2f6d-7414-4eb8-813e-1c063ee3a01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b73bb0>]}
[0m18:41:44.572577 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_transformation.dbt_transformation-on-run-start-0"
[0m18:41:44.576958 [info ] [MainThread]: 1 of 4 START hook: dbt_transformation.on-run-start.0 ........................... [RUN]
[0m18:41:44.577649 [debug] [MainThread]: Using snowflake connection "master"
[0m18:41:44.578023 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "master"} */
CREATE or REPLACE TABLE SKILLPATH_DB.RAW_DATA.STG_EDX_RAW (RAW_CONTENT VARIANT);
[0m18:41:44.578388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:45.321687 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.743 seconds
[0m18:41:45.324793 [info ] [MainThread]: 1 of 4 OK hook: dbt_transformation.on-run-start.0 .............................. [[32mOK[0m in 0.76s]
[0m18:41:45.330687 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_transformation.dbt_transformation-on-run-start-1"
[0m18:41:45.332430 [info ] [MainThread]: 2 of 4 START hook: dbt_transformation.on-run-start.1 ........................... [RUN]
[0m18:41:45.333581 [debug] [MainThread]: Using snowflake connection "master"
[0m18:41:45.334124 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "master"} */
COPY INTO STG_EDX_RAW FROM @SKILLPATH_DB.RAW_DATA.EDX_SCRAPED_STAGE FILE_FORMAT = (FORMAT_NAME = SKILLPATH_DB.RAW_DATA.JSON_FORMAT) ON_ERROR = 'CONTINUE';
[0m18:41:46.759987 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.425 seconds
[0m18:41:46.763070 [info ] [MainThread]: 2 of 4 OK hook: dbt_transformation.on-run-start.1 .............................. [[32mOK[0m in 1.44s]
[0m18:41:46.772644 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_transformation.dbt_transformation-on-run-start-2"
[0m18:41:46.774109 [info ] [MainThread]: 3 of 4 START hook: dbt_transformation.on-run-start.2 ........................... [RUN]
[0m18:41:46.774996 [debug] [MainThread]: Using snowflake connection "master"
[0m18:41:46.775377 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "master"} */
CREATE or REPLACE TABLE SKILLPATH_DB.RAW_DATA.STG_UDACITY_RAW (RAW_CONTENT VARIANT);
[0m18:41:47.376100 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.600 seconds
[0m18:41:47.378673 [info ] [MainThread]: 3 of 4 OK hook: dbt_transformation.on-run-start.2 .............................. [[32mOK[0m in 0.61s]
[0m18:41:47.386058 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_transformation.dbt_transformation-on-run-start-3"
[0m18:41:47.388699 [info ] [MainThread]: 4 of 4 START hook: dbt_transformation.on-run-start.3 ........................... [RUN]
[0m18:41:47.390055 [debug] [MainThread]: Using snowflake connection "master"
[0m18:41:47.390723 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "master"} */
COPY INTO STG_UDACITY_RAW FROM @SKILLPATH_DB.RAW_DATA.UDACITY_SCRAPED_STAGE FILE_FORMAT = (FORMAT_NAME = SKILLPATH_DB.RAW_DATA.JSON_FORMAT) ON_ERROR = 'CONTINUE';
[0m18:41:48.302057 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.910 seconds
[0m18:41:48.304545 [info ] [MainThread]: 4 of 4 OK hook: dbt_transformation.on-run-start.3 .............................. [[32mOK[0m in 0.92s]
[0m18:41:48.305470 [info ] [MainThread]: 
[0m18:41:48.312027 [debug] [Thread-1  ]: Began running node model.dbt_transformation.COURSERA_COURSES
[0m18:41:48.313849 [info ] [Thread-1  ]: 1 of 9 START sql table model RAW_DATA.COURSERA_COURSES ......................... [RUN]
[0m18:41:48.315018 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_SKILLPATH_DB_RAW_DATA, now model.dbt_transformation.COURSERA_COURSES)
[0m18:41:48.315525 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.COURSERA_COURSES
[0m18:41:48.320319 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.COURSERA_COURSES"
[0m18:41:48.321467 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.COURSERA_COURSES
[0m18:41:48.341585 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.COURSERA_COURSES"
[0m18:41:48.342081 [debug] [Thread-1  ]: On model.dbt_transformation.COURSERA_COURSES: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.COURSERA_COURSES"} */
CREATE OR REPLACE TABLE COURSERA_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@COURSERA_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m18:41:49.765537 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.423 seconds
[0m18:41:49.768905 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.COURSERA_COURSES"
[0m18:41:49.769599 [debug] [Thread-1  ]: On model.dbt_transformation.COURSERA_COURSES: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.COURSERA_COURSES"} */
COPY INTO COURSERA_COURSES FROM @COURSERA_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m18:41:50.676847 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.906 seconds
[0m18:41:50.703705 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.COURSERA_COURSES"
[0m18:41:50.705736 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.COURSERA_COURSES"
[0m18:41:50.706214 [debug] [Thread-1  ]: On model.dbt_transformation.COURSERA_COURSES: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.COURSERA_COURSES"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.COURSERA_COURSES
         as
        (

-- This SELECT statement is required by dbt. It simply returns the contents of the table.
SELECT * FROM COURSERA_COURSES
        );
[0m18:41:51.523662 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.817 seconds
[0m18:41:51.561384 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ed2f6d-7414-4eb8-813e-1c063ee3a01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a0c0a0>]}
[0m18:41:51.562533 [info ] [Thread-1  ]: 1 of 9 OK created sql table model RAW_DATA.COURSERA_COURSES .................... [[32mSUCCESS 1[0m in 3.24s]
[0m18:41:51.563247 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.COURSERA_COURSES
[0m18:41:51.563734 [debug] [Thread-1  ]: Began running node model.dbt_transformation.edx_courses
[0m18:41:51.564319 [info ] [Thread-1  ]: 2 of 9 START sql table model RAW_DATA.edx_courses .............................. [RUN]
[0m18:41:51.564787 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.COURSERA_COURSES, now model.dbt_transformation.edx_courses)
[0m18:41:51.565166 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.edx_courses
[0m18:41:51.570468 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.edx_courses"
[0m18:41:51.571292 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.edx_courses
[0m18:41:51.574370 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.edx_courses"
[0m18:41:51.574846 [debug] [Thread-1  ]: On model.dbt_transformation.edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.edx_courses"} */
CREATE OR REPLACE TABLE EDX_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@EDX_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m18:41:52.174007 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.598 seconds
[0m18:41:52.177667 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.edx_courses"
[0m18:41:52.178581 [debug] [Thread-1  ]: On model.dbt_transformation.edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.edx_courses"} */
COPY INTO EDX_COURSES FROM @EDX_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m18:41:53.018392 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.839 seconds
[0m18:41:53.021488 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.edx_courses"
[0m18:41:53.023430 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.edx_courses"
[0m18:41:53.024135 [debug] [Thread-1  ]: On model.dbt_transformation.edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.edx_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.edx_courses
         as
        (
 
SELECT * FROM EDX_COURSES
        );
[0m18:41:53.987034 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.962 seconds
[0m18:41:53.991293 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ed2f6d-7414-4eb8-813e-1c063ee3a01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f67f0>]}
[0m18:41:53.992447 [info ] [Thread-1  ]: 2 of 9 OK created sql table model RAW_DATA.edx_courses ......................... [[32mSUCCESS 1[0m in 2.43s]
[0m18:41:53.993271 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.edx_courses
[0m18:41:53.993798 [debug] [Thread-1  ]: Began running node model.dbt_transformation.my_first_dbt_model
[0m18:41:53.994540 [info ] [Thread-1  ]: 3 of 9 START sql view model RAW_DATA.my_first_dbt_model ........................ [RUN]
[0m18:41:53.995249 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.edx_courses, now model.dbt_transformation.my_first_dbt_model)
[0m18:41:53.995761 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.my_first_dbt_model
[0m18:41:54.000528 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.my_first_dbt_model"
[0m18:41:54.001580 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.my_first_dbt_model
[0m18:41:54.022304 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.my_first_dbt_model"
[0m18:41:54.023490 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.my_first_dbt_model"
[0m18:41:54.023886 [debug] [Thread-1  ]: On model.dbt_transformation.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.my_first_dbt_model"} */
create or replace   view SKILLPATH_DB.RAW_DATA.my_first_dbt_model
  
   as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:41:54.250477 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.226 seconds
[0m18:41:54.252678 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ed2f6d-7414-4eb8-813e-1c063ee3a01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12169d6d0>]}
[0m18:41:54.253327 [info ] [Thread-1  ]: 3 of 9 OK created sql view model RAW_DATA.my_first_dbt_model ................... [[32mSUCCESS 1[0m in 0.26s]
[0m18:41:54.253877 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.my_first_dbt_model
[0m18:41:54.254254 [debug] [Thread-1  ]: Began running node model.dbt_transformation.pluralsight_courses
[0m18:41:54.254809 [info ] [Thread-1  ]: 4 of 9 START sql table model RAW_DATA.pluralsight_courses ...................... [RUN]
[0m18:41:54.255338 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.my_first_dbt_model, now model.dbt_transformation.pluralsight_courses)
[0m18:41:54.255707 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.pluralsight_courses
[0m18:41:54.258944 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.pluralsight_courses"
[0m18:41:54.260256 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.pluralsight_courses
[0m18:41:54.263100 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.pluralsight_courses"
[0m18:41:54.263582 [debug] [Thread-1  ]: On model.dbt_transformation.pluralsight_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.pluralsight_courses"} */
CREATE OR REPLACE TABLE PLURALSIGHT_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@PLURALSIGHT_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m18:41:54.872240 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.608 seconds
[0m18:41:54.873905 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.pluralsight_courses"
[0m18:41:54.874364 [debug] [Thread-1  ]: On model.dbt_transformation.pluralsight_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.pluralsight_courses"} */
COPY INTO PLURALSIGHT_COURSES FROM @PLURALSIGHT_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m18:41:55.700633 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.825 seconds
[0m18:41:55.705520 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.pluralsight_courses"
[0m18:41:55.708003 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.pluralsight_courses"
[0m18:41:55.708603 [debug] [Thread-1  ]: On model.dbt_transformation.pluralsight_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.pluralsight_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.pluralsight_courses
         as
        (
 
SELECT * FROM PLURALSIGHT_COURSES
        );
[0m18:41:56.433384 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.724 seconds
[0m18:41:56.436711 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ed2f6d-7414-4eb8-813e-1c063ee3a01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216ad520>]}
[0m18:41:56.437575 [info ] [Thread-1  ]: 4 of 9 OK created sql table model RAW_DATA.pluralsight_courses ................. [[32mSUCCESS 1[0m in 2.18s]
[0m18:41:56.438150 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.pluralsight_courses
[0m18:41:56.438555 [debug] [Thread-1  ]: Began running node model.dbt_transformation.stg_edx_courses
[0m18:41:56.439173 [info ] [Thread-1  ]: 5 of 9 START sql table model RAW_DATA.stg_edx_courses .......................... [RUN]
[0m18:41:56.439638 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.pluralsight_courses, now model.dbt_transformation.stg_edx_courses)
[0m18:41:56.439998 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.stg_edx_courses
[0m18:41:56.444838 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.stg_edx_courses"
[0m18:41:56.445890 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.stg_edx_courses
[0m18:41:56.449610 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.stg_edx_courses"
[0m18:41:56.453084 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.stg_edx_courses"
[0m18:41:56.453799 [debug] [Thread-1  ]: On model.dbt_transformation.stg_edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.stg_edx_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.stg_edx_courses
         as
        (WITH source AS (
    SELECT * FROM SKILLPATH_DB.RAW_DATA.STG_EDX_RAW
),

transformed AS (
    SELECT 
        UUID_STRING() AS id,
        raw_content:URL::STRING AS url,
        TRIM(raw_content:course_name::STRING) AS course_name,
        TRIM(
            REGEXP_REPLACE(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(raw_content:course_description::VARCHAR, '\\n', ' '),
                    '\\r', ' '
                ),
                '\\t', ' '
            )
        ) AS description,
        NULLIF(TRIM(raw_content:prerequisites::STRING), 'Not found') AS prerequisites,
        CASE 
            WHEN raw_content:prerequisites::STRING IS NULL 
                 OR raw_content:prerequisites::STRING = 'Not found' 
                 OR raw_content:prerequisites::STRING = 'None' 
            THEN FALSE
            ELSE TRUE
        END AS has_prerequisites,
        NULLIF(
            REPLACE(raw_content:associated_skills::STRING, 'Not found', ''), 
            ''
        ) AS skills,
        TRIM(raw_content:level::STRING) AS level,
        CASE
            WHEN raw_content:language::STRING = 'en' THEN 'ENGLISH'
            ELSE 'OTHERS'
        END AS language,
        TRIM(raw_content:duration::STRING) AS duration,
        CASE 
            WHEN raw_content:duration::STRING LIKE '%weeks%' THEN 
                REGEXP_SUBSTR(raw_content:duration::STRING, '[0-9]+')::FLOAT * 168  -- Weeks to hours
            WHEN raw_content:duration::STRING LIKE '%week%' THEN 
                REGEXP_SUBSTR(raw_content:duration::STRING, '[0-9]+')::FLOAT * 168  -- Weeks to hours
            ELSE NULL
        END AS duration_hours,
        COALESCE(
            TRY_CAST(
                CASE 
                    WHEN raw_content:rating::STRING = 'Not found' THEN '-1'
                    ELSE raw_content:rating::STRING 
                END AS FLOAT
            ), 
            -1
        ) AS rating,
        'edX' AS source,
        CURRENT_TIMESTAMP AS ingestion_time
    FROM source
)

SELECT * FROM transformed
        );
[0m18:41:57.459350 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.004 seconds
[0m18:41:57.462334 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ed2f6d-7414-4eb8-813e-1c063ee3a01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a94160>]}
[0m18:41:57.463093 [info ] [Thread-1  ]: 5 of 9 OK created sql table model RAW_DATA.stg_edx_courses ..................... [[32mSUCCESS 1[0m in 1.02s]
[0m18:41:57.463808 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.stg_edx_courses
[0m18:41:57.464241 [debug] [Thread-1  ]: Began running node model.dbt_transformation.stg_udacity_courses
[0m18:41:57.464834 [info ] [Thread-1  ]: 6 of 9 START sql table model RAW_DATA.stg_udacity_courses ...................... [RUN]
[0m18:41:57.465345 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.stg_edx_courses, now model.dbt_transformation.stg_udacity_courses)
[0m18:41:57.465845 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.stg_udacity_courses
[0m18:41:57.470013 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.stg_udacity_courses"
[0m18:41:57.470715 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.stg_udacity_courses
[0m18:41:57.474514 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.stg_udacity_courses"
[0m18:41:57.477398 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.stg_udacity_courses"
[0m18:41:57.477914 [debug] [Thread-1  ]: On model.dbt_transformation.stg_udacity_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.stg_udacity_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.stg_udacity_courses
         as
        (WITH source AS (
    SELECT * FROM SKILLPATH_DB.RAW_DATA.STG_UDACITY_RAW
),

transformed AS (
    SELECT 
        UUID_STRING() AS id,
        raw_content:URL::STRING AS url,
        TRIM(raw_content:"Course Name"::STRING) AS course_name,
        TRIM(
            REGEXP_REPLACE(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(raw_content:Description::VARCHAR, '\\n', ' '),
                '\\r', ' '
            ),
            '\\t', ' '
            )
        ) AS description,
        NULLIF(ARRAY_TO_STRING(SPLIT(TRIM(raw_content:Prerequisites::STRING), ','), ', '), '') AS prerequisites,
        CASE 
            WHEN raw_content:Prerequisites::STRING IS NULL OR raw_content:Prerequisites::STRING = '' THEN FALSE
            ELSE TRUE
        END AS has_prerequisites,
        NULLIF(ARRAY_TO_STRING(SPLIT(TRIM(raw_content:Skills::STRING), ', '), ', '), '') AS skills,
        TRIM(raw_content:Level::STRING) AS level,
        CASE
            WHEN raw_content:Language::STRING LIKE 'en' THEN
            'ENGLISH'
            ELSE 'OTHERS'
         END AS language,
        CONCAT(
            REGEXP_SUBSTR(raw_content:Duration::VARCHAR, '[0-9]+'), ' ',
            CASE 
                WHEN raw_content:Duration::VARCHAR LIKE 'P%M' THEN 'months'
                WHEN raw_content:Duration::VARCHAR LIKE 'P%W' THEN 'weeks'
                WHEN raw_content:Duration::VARCHAR LIKE 'PT%H' THEN 'hours'
                ELSE 'unknown'
            END
        ) AS duration,
        CASE 
            WHEN raw_content:Duration::STRING LIKE 'P%M' THEN 
                REGEXP_SUBSTR(raw_content:Duration::STRING, '[0-9]+')::FLOAT * 730  -- Months to hours
            WHEN raw_content:Duration::STRING LIKE 'P%W' THEN 
                REGEXP_SUBSTR(raw_content:Duration::STRING, '[0-9]+')::FLOAT * 168  -- Weeks to hours
            WHEN raw_content:Duration::STRING LIKE 'PT%H' THEN 
                REGEXP_SUBSTR(raw_content:Duration::STRING, '[0-9]+')::FLOAT       -- Hours
            ELSE NULL
        END AS duration_hours,
        COALESCE(TRY_CAST(raw_content:Rating::STRING AS FLOAT),-1) AS rating,
        'Udacity' AS source,
        CURRENT_TIMESTAMP AS ingestion_time
    FROM source
)

SELECT * FROM transformed
        );
[0m18:41:58.405643 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.927 seconds
[0m18:41:58.411687 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ed2f6d-7414-4eb8-813e-1c063ee3a01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216edeb0>]}
[0m18:41:58.413094 [info ] [Thread-1  ]: 6 of 9 OK created sql table model RAW_DATA.stg_udacity_courses ................. [[32mSUCCESS 1[0m in 0.95s]
[0m18:41:58.414014 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.stg_udacity_courses
[0m18:41:58.414665 [debug] [Thread-1  ]: Began running node model.dbt_transformation.udacity_courses
[0m18:41:58.415511 [info ] [Thread-1  ]: 7 of 9 START sql table model RAW_DATA.udacity_courses .......................... [RUN]
[0m18:41:58.416637 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.stg_udacity_courses, now model.dbt_transformation.udacity_courses)
[0m18:41:58.417334 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.udacity_courses
[0m18:41:58.423553 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.udacity_courses"
[0m18:41:58.424790 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.udacity_courses
[0m18:41:58.430860 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udacity_courses"
[0m18:41:58.431370 [debug] [Thread-1  ]: On model.dbt_transformation.udacity_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udacity_courses"} */
CREATE OR REPLACE TABLE UDACITY_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@UDACITY_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m18:41:58.710833 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01bb40d1-0204-ccc2-0003-d5630032d19e
[0m18:41:58.711606 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000668 (22023): SQL compilation error:
Invalid template: template must be a non-null JSON array

[0m18:41:58.714696 [debug] [Thread-1  ]: Database Error in model udacity_courses (models/table_creation/udacity_courses.sql)
  000668 (22023): SQL compilation error:
  Invalid template: template must be a non-null JSON array
  
[0m18:41:58.715568 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ed2f6d-7414-4eb8-813e-1c063ee3a01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117725790>]}
[0m18:41:58.716541 [error] [Thread-1  ]: 7 of 9 ERROR creating sql table model RAW_DATA.udacity_courses ................. [[31mERROR[0m in 0.30s]
[0m18:41:58.717299 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.udacity_courses
[0m18:41:58.717828 [debug] [Thread-1  ]: Began running node model.dbt_transformation.udemy_courses
[0m18:41:58.718510 [debug] [Thread-4  ]: Marking all children of 'model.dbt_transformation.udacity_courses' to be skipped because of status 'error'.  Reason: Database Error in model udacity_courses (models/table_creation/udacity_courses.sql)
  000668 (22023): SQL compilation error:
  Invalid template: template must be a non-null JSON array
  .
[0m18:41:58.719166 [info ] [Thread-1  ]: 8 of 9 START sql table model RAW_DATA.udemy_courses ............................ [RUN]
[0m18:41:58.720116 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.udacity_courses, now model.dbt_transformation.udemy_courses)
[0m18:41:58.720587 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.udemy_courses
[0m18:41:58.725010 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.udemy_courses"
[0m18:41:58.726238 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.udemy_courses
[0m18:41:58.729743 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udemy_courses"
[0m18:41:58.730173 [debug] [Thread-1  ]: On model.dbt_transformation.udemy_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udemy_courses"} */
CREATE OR REPLACE TABLE UDEMY_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@UDEMY_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m18:42:05.424384 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 6.692 seconds
[0m18:42:05.429583 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udemy_courses"
[0m18:42:05.430059 [debug] [Thread-1  ]: On model.dbt_transformation.udemy_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udemy_courses"} */
COPY INTO UDEMY_COURSES FROM @UDEMY_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m18:42:10.006026 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.574 seconds
[0m18:42:10.008602 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.udemy_courses"
[0m18:42:10.009904 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udemy_courses"
[0m18:42:10.010279 [debug] [Thread-1  ]: On model.dbt_transformation.udemy_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udemy_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.udemy_courses
         as
        (
 
SELECT * FROM UDEMY_COURSES
        );
[0m18:42:13.768031 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.754 seconds
[0m18:42:13.783147 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ed2f6d-7414-4eb8-813e-1c063ee3a01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a57280>]}
[0m18:42:13.784809 [info ] [Thread-1  ]: 8 of 9 OK created sql table model RAW_DATA.udemy_courses ....................... [[32mSUCCESS 1[0m in 15.06s]
[0m18:42:13.785639 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.udemy_courses
[0m18:42:13.786209 [debug] [Thread-1  ]: Began running node model.dbt_transformation.my_second_dbt_model
[0m18:42:13.787215 [info ] [Thread-1  ]: 9 of 9 START sql view model RAW_DATA.my_second_dbt_model ....................... [RUN]
[0m18:42:13.787943 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.udemy_courses, now model.dbt_transformation.my_second_dbt_model)
[0m18:42:13.788407 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.my_second_dbt_model
[0m18:42:13.795092 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.my_second_dbt_model"
[0m18:42:13.796072 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.my_second_dbt_model
[0m18:42:13.799435 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.my_second_dbt_model"
[0m18:42:13.800523 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.my_second_dbt_model"
[0m18:42:13.800901 [debug] [Thread-1  ]: On model.dbt_transformation.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.my_second_dbt_model"} */
create or replace   view SKILLPATH_DB.RAW_DATA.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from SKILLPATH_DB.RAW_DATA.my_first_dbt_model
where id = 1
  );
[0m18:42:14.144491 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.343 seconds
[0m18:42:14.146847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ed2f6d-7414-4eb8-813e-1c063ee3a01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126802610>]}
[0m18:42:14.147537 [info ] [Thread-1  ]: 9 of 9 OK created sql view model RAW_DATA.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.36s]
[0m18:42:14.148086 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.my_second_dbt_model
[0m18:42:14.149911 [debug] [MainThread]: Connection 'master' was left open.
[0m18:42:14.150299 [debug] [MainThread]: On master: Close
[0m18:42:14.391346 [debug] [MainThread]: Connection 'model.dbt_transformation.my_second_dbt_model' was left open.
[0m18:42:14.392169 [debug] [MainThread]: On model.dbt_transformation.my_second_dbt_model: Close
[0m18:42:14.660361 [info ] [MainThread]: 
[0m18:42:14.661385 [info ] [MainThread]: Finished running 4 project hooks, 7 table models, 2 view models in 0 hours 0 minutes and 31.53 seconds (31.53s).
[0m18:42:14.666488 [debug] [MainThread]: Command end result
[0m18:42:14.700578 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/manifest.json
[0m18:42:14.704913 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/semantic_manifest.json
[0m18:42:14.712193 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/run_results.json
[0m18:42:14.712536 [info ] [MainThread]: 
[0m18:42:14.712929 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:42:14.713349 [info ] [MainThread]: 
[0m18:42:14.713801 [error] [MainThread]:   Database Error in model udacity_courses (models/table_creation/udacity_courses.sql)
  000668 (22023): SQL compilation error:
  Invalid template: template must be a non-null JSON array
  
[0m18:42:14.714133 [info ] [MainThread]: 
[0m18:42:14.714474 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m18:42:14.729476 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 34.51975, "process_in_blocks": "0", "process_kernel_time": 0.59724, "process_mem_max_rss": "194412544", "process_out_blocks": "0", "process_user_time": 4.157109}
[0m18:42:14.730025 [debug] [MainThread]: Command `dbt run` failed at 18:42:14.729936 after 34.52 seconds
[0m18:42:14.730471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110216b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111646fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201db8e0>]}
[0m18:42:14.730850 [debug] [MainThread]: Flushing usage events
[0m18:42:14.870430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:50:18.045483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107857be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211f4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211f42b0>]}


============================== 18:50:18.050570 | 0f9ffab5-d167-41fb-ac7b-fa663abf5dee ==============================
[0m18:50:18.050570 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:50:18.051176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/anusreemohanan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:50:19.044505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f9ffab5-d167-41fb-ac7b-fa663abf5dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126665280>]}
[0m18:50:19.096094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f9ffab5-d167-41fb-ac7b-fa663abf5dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12665a160>]}
[0m18:50:19.097122 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:50:19.253189 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:50:19.455903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:50:19.456687 [debug] [MainThread]: Partial parsing: updated file: dbt_transformation://models/staging/stg_edx_courses.sql
[0m18:50:19.769232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f9ffab5-d167-41fb-ac7b-fa663abf5dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1265763a0>]}
[0m18:50:19.883273 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/manifest.json
[0m18:50:19.884800 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/semantic_manifest.json
[0m18:50:19.903854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f9ffab5-d167-41fb-ac7b-fa663abf5dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127767640>]}
[0m18:50:19.904422 [info ] [MainThread]: Found 9 models, 4 operations, 4 data tests, 2 sources, 479 macros
[0m18:50:19.904791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f9ffab5-d167-41fb-ac7b-fa663abf5dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12762e580>]}
[0m18:50:19.906440 [info ] [MainThread]: 
[0m18:50:19.906805 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:50:19.907103 [info ] [MainThread]: 
[0m18:50:19.908030 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:50:19.913720 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SKILLPATH_DB'
[0m18:50:19.980920 [debug] [ThreadPool]: Using snowflake connection "list_SKILLPATH_DB"
[0m18:50:19.981375 [debug] [ThreadPool]: On list_SKILLPATH_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "list_SKILLPATH_DB"} */
show terse schemas in database SKILLPATH_DB
    limit 10000
[0m18:50:19.981701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:20.694716 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.713 seconds
[0m18:50:20.697661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SKILLPATH_DB, now list_SKILLPATH_DB_RAW_DATA)
[0m18:50:20.709315 [debug] [ThreadPool]: Using snowflake connection "list_SKILLPATH_DB_RAW_DATA"
[0m18:50:20.709739 [debug] [ThreadPool]: On list_SKILLPATH_DB_RAW_DATA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "list_SKILLPATH_DB_RAW_DATA"} */
show objects in SKILLPATH_DB.RAW_DATA limit 10000;
[0m18:50:20.872450 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.162 seconds
[0m18:50:20.877947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f9ffab5-d167-41fb-ac7b-fa663abf5dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130c1bfa0>]}
[0m18:50:20.888474 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_transformation.dbt_transformation-on-run-start-0"
[0m18:50:20.892326 [info ] [MainThread]: 1 of 4 START hook: dbt_transformation.on-run-start.0 ........................... [RUN]
[0m18:50:20.892992 [debug] [MainThread]: Using snowflake connection "master"
[0m18:50:20.893361 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "master"} */
CREATE or REPLACE TABLE SKILLPATH_DB.RAW_DATA.STG_EDX_RAW (RAW_CONTENT VARIANT);
[0m18:50:20.893690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:21.593282 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.699 seconds
[0m18:50:21.597161 [info ] [MainThread]: 1 of 4 OK hook: dbt_transformation.on-run-start.0 .............................. [[32mOK[0m in 0.72s]
[0m18:50:21.604180 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_transformation.dbt_transformation-on-run-start-1"
[0m18:50:21.605992 [info ] [MainThread]: 2 of 4 START hook: dbt_transformation.on-run-start.1 ........................... [RUN]
[0m18:50:21.607022 [debug] [MainThread]: Using snowflake connection "master"
[0m18:50:21.607536 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "master"} */
COPY INTO STG_EDX_RAW FROM @SKILLPATH_DB.RAW_DATA.EDX_SCRAPED_STAGE FILE_FORMAT = (FORMAT_NAME = SKILLPATH_DB.RAW_DATA.JSON_FORMAT) ON_ERROR = 'CONTINUE';
[0m18:50:23.007188 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.399 seconds
[0m18:50:23.010067 [info ] [MainThread]: 2 of 4 OK hook: dbt_transformation.on-run-start.1 .............................. [[32mOK[0m in 1.41s]
[0m18:50:23.016144 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_transformation.dbt_transformation-on-run-start-2"
[0m18:50:23.018106 [info ] [MainThread]: 3 of 4 START hook: dbt_transformation.on-run-start.2 ........................... [RUN]
[0m18:50:23.019003 [debug] [MainThread]: Using snowflake connection "master"
[0m18:50:23.019461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "master"} */
CREATE or REPLACE TABLE SKILLPATH_DB.RAW_DATA.STG_UDACITY_RAW (RAW_CONTENT VARIANT);
[0m18:50:23.312154 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.292 seconds
[0m18:50:23.315079 [info ] [MainThread]: 3 of 4 OK hook: dbt_transformation.on-run-start.2 .............................. [[32mOK[0m in 0.30s]
[0m18:50:23.324202 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_transformation.dbt_transformation-on-run-start-3"
[0m18:50:23.325838 [info ] [MainThread]: 4 of 4 START hook: dbt_transformation.on-run-start.3 ........................... [RUN]
[0m18:50:23.326939 [debug] [MainThread]: Using snowflake connection "master"
[0m18:50:23.327444 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "master"} */
COPY INTO STG_UDACITY_RAW FROM @SKILLPATH_DB.RAW_DATA.UDACITY_SCRAPED_STAGE FILE_FORMAT = (FORMAT_NAME = SKILLPATH_DB.RAW_DATA.JSON_FORMAT) ON_ERROR = 'CONTINUE';
[0m18:50:24.573153 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.245 seconds
[0m18:50:24.576490 [info ] [MainThread]: 4 of 4 OK hook: dbt_transformation.on-run-start.3 .............................. [[32mOK[0m in 1.26s]
[0m18:50:24.577380 [info ] [MainThread]: 
[0m18:50:24.585220 [debug] [Thread-1  ]: Began running node model.dbt_transformation.COURSERA_COURSES
[0m18:50:24.586485 [info ] [Thread-1  ]: 1 of 9 START sql table model RAW_DATA.COURSERA_COURSES ......................... [RUN]
[0m18:50:24.587364 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_SKILLPATH_DB_RAW_DATA, now model.dbt_transformation.COURSERA_COURSES)
[0m18:50:24.588052 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.COURSERA_COURSES
[0m18:50:24.595528 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.COURSERA_COURSES"
[0m18:50:24.596620 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.COURSERA_COURSES
[0m18:50:24.615500 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.COURSERA_COURSES"
[0m18:50:24.615951 [debug] [Thread-1  ]: On model.dbt_transformation.COURSERA_COURSES: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.COURSERA_COURSES"} */
CREATE OR REPLACE TABLE COURSERA_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@COURSERA_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m18:50:25.274115 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.657 seconds
[0m18:50:25.277877 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.COURSERA_COURSES"
[0m18:50:25.278681 [debug] [Thread-1  ]: On model.dbt_transformation.COURSERA_COURSES: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.COURSERA_COURSES"} */
COPY INTO COURSERA_COURSES FROM @COURSERA_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m18:50:26.281470 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.002 seconds
[0m18:50:26.306274 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.COURSERA_COURSES"
[0m18:50:26.307843 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.COURSERA_COURSES"
[0m18:50:26.308318 [debug] [Thread-1  ]: On model.dbt_transformation.COURSERA_COURSES: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.COURSERA_COURSES"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.COURSERA_COURSES
         as
        (

-- This SELECT statement is required by dbt. It simply returns the contents of the table.
SELECT * FROM COURSERA_COURSES
        );
[0m18:50:27.077606 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.769 seconds
[0m18:50:27.107565 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f9ffab5-d167-41fb-ac7b-fa663abf5dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e554c0>]}
[0m18:50:27.108498 [info ] [Thread-1  ]: 1 of 9 OK created sql table model RAW_DATA.COURSERA_COURSES .................... [[32mSUCCESS 1[0m in 2.52s]
[0m18:50:27.109087 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.COURSERA_COURSES
[0m18:50:27.109472 [debug] [Thread-1  ]: Began running node model.dbt_transformation.edx_courses
[0m18:50:27.110017 [info ] [Thread-1  ]: 2 of 9 START sql table model RAW_DATA.edx_courses .............................. [RUN]
[0m18:50:27.110463 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.COURSERA_COURSES, now model.dbt_transformation.edx_courses)
[0m18:50:27.110812 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.edx_courses
[0m18:50:27.113992 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.edx_courses"
[0m18:50:27.114830 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.edx_courses
[0m18:50:27.117898 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.edx_courses"
[0m18:50:27.118298 [debug] [Thread-1  ]: On model.dbt_transformation.edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.edx_courses"} */
CREATE OR REPLACE TABLE EDX_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@EDX_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m18:50:28.020353 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.902 seconds
[0m18:50:28.022502 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.edx_courses"
[0m18:50:28.023414 [debug] [Thread-1  ]: On model.dbt_transformation.edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.edx_courses"} */
COPY INTO EDX_COURSES FROM @EDX_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m18:50:28.768871 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.744 seconds
[0m18:50:28.774625 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.edx_courses"
[0m18:50:28.776255 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.edx_courses"
[0m18:50:28.776785 [debug] [Thread-1  ]: On model.dbt_transformation.edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.edx_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.edx_courses
         as
        (
 
SELECT * FROM EDX_COURSES
        );
[0m18:50:29.477530 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.700 seconds
[0m18:50:29.482279 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f9ffab5-d167-41fb-ac7b-fa663abf5dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107626490>]}
[0m18:50:29.483534 [info ] [Thread-1  ]: 2 of 9 OK created sql table model RAW_DATA.edx_courses ......................... [[32mSUCCESS 1[0m in 2.37s]
[0m18:50:29.484475 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.edx_courses
[0m18:50:29.485115 [debug] [Thread-1  ]: Began running node model.dbt_transformation.my_first_dbt_model
[0m18:50:29.485973 [info ] [Thread-1  ]: 3 of 9 START sql view model RAW_DATA.my_first_dbt_model ........................ [RUN]
[0m18:50:29.486826 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.edx_courses, now model.dbt_transformation.my_first_dbt_model)
[0m18:50:29.487446 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.my_first_dbt_model
[0m18:50:29.492663 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.my_first_dbt_model"
[0m18:50:29.494062 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.my_first_dbt_model
[0m18:50:29.516243 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.my_first_dbt_model"
[0m18:50:29.517407 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.my_first_dbt_model"
[0m18:50:29.517808 [debug] [Thread-1  ]: On model.dbt_transformation.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.my_first_dbt_model"} */
create or replace   view SKILLPATH_DB.RAW_DATA.my_first_dbt_model
  
   as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:50:29.768342 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.250 seconds
[0m18:50:29.774214 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f9ffab5-d167-41fb-ac7b-fa663abf5dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e786a0>]}
[0m18:50:29.775791 [info ] [Thread-1  ]: 3 of 9 OK created sql view model RAW_DATA.my_first_dbt_model ................... [[32mSUCCESS 1[0m in 0.29s]
[0m18:50:29.776964 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.my_first_dbt_model
[0m18:50:29.778152 [debug] [Thread-1  ]: Began running node model.dbt_transformation.pluralsight_courses
[0m18:50:29.779236 [info ] [Thread-1  ]: 4 of 9 START sql table model RAW_DATA.pluralsight_courses ...................... [RUN]
[0m18:50:29.780247 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.my_first_dbt_model, now model.dbt_transformation.pluralsight_courses)
[0m18:50:29.780834 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.pluralsight_courses
[0m18:50:29.786712 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.pluralsight_courses"
[0m18:50:29.789397 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.pluralsight_courses
[0m18:50:29.793784 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.pluralsight_courses"
[0m18:50:29.794490 [debug] [Thread-1  ]: On model.dbt_transformation.pluralsight_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.pluralsight_courses"} */
CREATE OR REPLACE TABLE PLURALSIGHT_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@PLURALSIGHT_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m18:50:30.833350 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.038 seconds
[0m18:50:30.835817 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.pluralsight_courses"
[0m18:50:30.836404 [debug] [Thread-1  ]: On model.dbt_transformation.pluralsight_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.pluralsight_courses"} */
COPY INTO PLURALSIGHT_COURSES FROM @PLURALSIGHT_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m18:50:31.747482 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.910 seconds
[0m18:50:31.751840 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.pluralsight_courses"
[0m18:50:31.754937 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.pluralsight_courses"
[0m18:50:31.755605 [debug] [Thread-1  ]: On model.dbt_transformation.pluralsight_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.pluralsight_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.pluralsight_courses
         as
        (
 
SELECT * FROM PLURALSIGHT_COURSES
        );
[0m18:50:33.113320 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.357 seconds
[0m18:50:33.123071 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f9ffab5-d167-41fb-ac7b-fa663abf5dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e498e0>]}
[0m18:50:33.124596 [info ] [Thread-1  ]: 4 of 9 OK created sql table model RAW_DATA.pluralsight_courses ................. [[32mSUCCESS 1[0m in 3.34s]
[0m18:50:33.125666 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.pluralsight_courses
[0m18:50:33.126507 [debug] [Thread-1  ]: Began running node model.dbt_transformation.stg_edx_courses
[0m18:50:33.127417 [info ] [Thread-1  ]: 5 of 9 START sql table model RAW_DATA.stg_edx_courses .......................... [RUN]
[0m18:50:33.128261 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.pluralsight_courses, now model.dbt_transformation.stg_edx_courses)
[0m18:50:33.128878 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.stg_edx_courses
[0m18:50:33.134854 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.stg_edx_courses"
[0m18:50:33.135942 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.stg_edx_courses
[0m18:50:33.139809 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.stg_edx_courses"
[0m18:50:33.143068 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.stg_edx_courses"
[0m18:50:33.143846 [debug] [Thread-1  ]: On model.dbt_transformation.stg_edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.stg_edx_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.stg_edx_courses
         as
        (WITH source AS (
    SELECT * FROM SKILLPATH_DB.RAW_DATA.STG_EDX_RAW
),

transformed AS (
    SELECT 
        UUID_STRING() AS id,
        raw_content:URL::STRING AS url,
        TRIM(raw_content:course_name::STRING) AS course_name,
        TRIM(
            REGEXP_REPLACE(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(raw_content:course_description::VARCHAR, '\\n', ' '),
                    '\\r', ' '
                ),
                '\\t', ' '
            )
        ) AS description,
        NULLIF(TRIM(raw_content:prerequisites::STRING), 'Not found') AS prerequisites,
        CASE 
            WHEN raw_content:prerequisites::STRING IS NULL 
                 OR raw_content:prerequisites::STRING = 'Not found' 
                 OR raw_content:prerequisites::STRING = 'None'
                 OR raw_content:prerequisites::STRING = 'None.'
            THEN FALSE
            ELSE TRUE
        END AS has_prerequisites,
        NULLIF(
            REPLACE(raw_content:associated_skills::STRING, 'Not found', ''), 
            ''
        ) AS skills,
        TRIM(raw_content:level::STRING) AS level,
        CASE
            WHEN raw_content:language::STRING = 'en' THEN 'ENGLISH'
            ELSE 'OTHERS'
        END AS language,
        TRIM(raw_content:duration::STRING) AS duration,
        CASE 
            WHEN raw_content:duration::STRING LIKE '%weeks%' THEN 
                REGEXP_SUBSTR(raw_content:duration::STRING, '[0-9]+')::FLOAT * 168  -- Weeks to hours
            WHEN raw_content:duration::STRING LIKE '%week%' THEN 
                REGEXP_SUBSTR(raw_content:duration::STRING, '[0-9]+')::FLOAT * 168  -- Weeks to hours
            ELSE NULL
        END AS duration_hours,
        COALESCE(
            TRY_CAST(
                CASE 
                    WHEN raw_content:rating::STRING = 'Not found' THEN '-1'
                    ELSE raw_content:rating::STRING 
                END AS FLOAT
            ), 
            -1
        ) AS rating,
        'edX' AS source,
        CURRENT_TIMESTAMP AS ingestion_time
    FROM source
)

SELECT * FROM transformed
        );
[0m18:50:34.036625 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.892 seconds
[0m18:50:34.045319 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f9ffab5-d167-41fb-ac7b-fa663abf5dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130ed8bb0>]}
[0m18:50:34.047025 [info ] [Thread-1  ]: 5 of 9 OK created sql table model RAW_DATA.stg_edx_courses ..................... [[32mSUCCESS 1[0m in 0.92s]
[0m18:50:34.048322 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.stg_edx_courses
[0m18:50:34.049001 [debug] [Thread-1  ]: Began running node model.dbt_transformation.stg_udacity_courses
[0m18:50:34.049909 [info ] [Thread-1  ]: 6 of 9 START sql table model RAW_DATA.stg_udacity_courses ...................... [RUN]
[0m18:50:34.050791 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.stg_edx_courses, now model.dbt_transformation.stg_udacity_courses)
[0m18:50:34.051418 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.stg_udacity_courses
[0m18:50:34.056569 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.stg_udacity_courses"
[0m18:50:34.057706 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.stg_udacity_courses
[0m18:50:34.061518 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.stg_udacity_courses"
[0m18:50:34.065226 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.stg_udacity_courses"
[0m18:50:34.065856 [debug] [Thread-1  ]: On model.dbt_transformation.stg_udacity_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.stg_udacity_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.stg_udacity_courses
         as
        (WITH source AS (
    SELECT * FROM SKILLPATH_DB.RAW_DATA.STG_UDACITY_RAW
),

transformed AS (
    SELECT 
        UUID_STRING() AS id,
        raw_content:URL::STRING AS url,
        TRIM(raw_content:"Course Name"::STRING) AS course_name,
        TRIM(
            REGEXP_REPLACE(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(raw_content:Description::VARCHAR, '\\n', ' '),
                '\\r', ' '
            ),
            '\\t', ' '
            )
        ) AS description,
        NULLIF(ARRAY_TO_STRING(SPLIT(TRIM(raw_content:Prerequisites::STRING), ','), ', '), '') AS prerequisites,
        CASE 
            WHEN raw_content:Prerequisites::STRING IS NULL OR raw_content:Prerequisites::STRING = '' THEN FALSE
            ELSE TRUE
        END AS has_prerequisites,
        NULLIF(ARRAY_TO_STRING(SPLIT(TRIM(raw_content:Skills::STRING), ', '), ', '), '') AS skills,
        TRIM(raw_content:Level::STRING) AS level,
        CASE
            WHEN raw_content:Language::STRING LIKE 'en' THEN
            'ENGLISH'
            ELSE 'OTHERS'
         END AS language,
        CONCAT(
            REGEXP_SUBSTR(raw_content:Duration::VARCHAR, '[0-9]+'), ' ',
            CASE 
                WHEN raw_content:Duration::VARCHAR LIKE 'P%M' THEN 'months'
                WHEN raw_content:Duration::VARCHAR LIKE 'P%W' THEN 'weeks'
                WHEN raw_content:Duration::VARCHAR LIKE 'PT%H' THEN 'hours'
                ELSE 'unknown'
            END
        ) AS duration,
        CASE 
            WHEN raw_content:Duration::STRING LIKE 'P%M' THEN 
                REGEXP_SUBSTR(raw_content:Duration::STRING, '[0-9]+')::FLOAT * 730  -- Months to hours
            WHEN raw_content:Duration::STRING LIKE 'P%W' THEN 
                REGEXP_SUBSTR(raw_content:Duration::STRING, '[0-9]+')::FLOAT * 168  -- Weeks to hours
            WHEN raw_content:Duration::STRING LIKE 'PT%H' THEN 
                REGEXP_SUBSTR(raw_content:Duration::STRING, '[0-9]+')::FLOAT       -- Hours
            ELSE NULL
        END AS duration_hours,
        COALESCE(TRY_CAST(raw_content:Rating::STRING AS FLOAT),-1) AS rating,
        'Udacity' AS source,
        CURRENT_TIMESTAMP AS ingestion_time
    FROM source
)

SELECT * FROM transformed
        );
[0m18:50:35.341570 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.275 seconds
[0m18:50:35.344705 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f9ffab5-d167-41fb-ac7b-fa663abf5dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130ed8bb0>]}
[0m18:50:35.345654 [info ] [Thread-1  ]: 6 of 9 OK created sql table model RAW_DATA.stg_udacity_courses ................. [[32mSUCCESS 1[0m in 1.29s]
[0m18:50:35.346316 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.stg_udacity_courses
[0m18:50:35.346763 [debug] [Thread-1  ]: Began running node model.dbt_transformation.udacity_courses
[0m18:50:35.347320 [info ] [Thread-1  ]: 7 of 9 START sql table model RAW_DATA.udacity_courses .......................... [RUN]
[0m18:50:35.347861 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.stg_udacity_courses, now model.dbt_transformation.udacity_courses)
[0m18:50:35.348275 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.udacity_courses
[0m18:50:35.351897 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.udacity_courses"
[0m18:50:35.352715 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.udacity_courses
[0m18:50:35.355801 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udacity_courses"
[0m18:50:35.356188 [debug] [Thread-1  ]: On model.dbt_transformation.udacity_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udacity_courses"} */
CREATE OR REPLACE TABLE UDACITY_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@UDACITY_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m18:50:35.639854 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01bb40da-0204-ccc2-0003-d5630032d356
[0m18:50:35.640684 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000668 (22023): SQL compilation error:
Invalid template: template must be a non-null JSON array

[0m18:50:35.643755 [debug] [Thread-1  ]: Database Error in model udacity_courses (models/table_creation/udacity_courses.sql)
  000668 (22023): SQL compilation error:
  Invalid template: template must be a non-null JSON array
  
[0m18:50:35.644701 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f9ffab5-d167-41fb-ac7b-fa663abf5dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130efde20>]}
[0m18:50:35.645783 [error] [Thread-1  ]: 7 of 9 ERROR creating sql table model RAW_DATA.udacity_courses ................. [[31mERROR[0m in 0.30s]
[0m18:50:35.646564 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.udacity_courses
[0m18:50:35.647083 [debug] [Thread-1  ]: Began running node model.dbt_transformation.udemy_courses
[0m18:50:35.647736 [debug] [Thread-4  ]: Marking all children of 'model.dbt_transformation.udacity_courses' to be skipped because of status 'error'.  Reason: Database Error in model udacity_courses (models/table_creation/udacity_courses.sql)
  000668 (22023): SQL compilation error:
  Invalid template: template must be a non-null JSON array
  .
[0m18:50:35.648355 [info ] [Thread-1  ]: 8 of 9 START sql table model RAW_DATA.udemy_courses ............................ [RUN]
[0m18:50:35.649325 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.udacity_courses, now model.dbt_transformation.udemy_courses)
[0m18:50:35.649800 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.udemy_courses
[0m18:50:35.654448 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.udemy_courses"
[0m18:50:35.655295 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.udemy_courses
[0m18:50:35.658713 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udemy_courses"
[0m18:50:35.659178 [debug] [Thread-1  ]: On model.dbt_transformation.udemy_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udemy_courses"} */
CREATE OR REPLACE TABLE UDEMY_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@UDEMY_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m18:50:42.484220 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 6.824 seconds
[0m18:50:42.489130 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udemy_courses"
[0m18:50:42.489576 [debug] [Thread-1  ]: On model.dbt_transformation.udemy_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udemy_courses"} */
COPY INTO UDEMY_COURSES FROM @UDEMY_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m18:50:46.912057 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.422 seconds
[0m18:50:46.918032 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.udemy_courses"
[0m18:50:46.920556 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udemy_courses"
[0m18:50:46.921182 [debug] [Thread-1  ]: On model.dbt_transformation.udemy_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udemy_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.udemy_courses
         as
        (
 
SELECT * FROM UDEMY_COURSES
        );
[0m18:50:49.597868 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.676 seconds
[0m18:50:49.604844 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f9ffab5-d167-41fb-ac7b-fa663abf5dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13736ff70>]}
[0m18:50:49.606314 [info ] [Thread-1  ]: 8 of 9 OK created sql table model RAW_DATA.udemy_courses ....................... [[32mSUCCESS 1[0m in 13.95s]
[0m18:50:49.607229 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.udemy_courses
[0m18:50:49.607826 [debug] [Thread-1  ]: Began running node model.dbt_transformation.my_second_dbt_model
[0m18:50:49.608778 [info ] [Thread-1  ]: 9 of 9 START sql view model RAW_DATA.my_second_dbt_model ....................... [RUN]
[0m18:50:49.609434 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.udemy_courses, now model.dbt_transformation.my_second_dbt_model)
[0m18:50:49.609921 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.my_second_dbt_model
[0m18:50:49.616341 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.my_second_dbt_model"
[0m18:50:49.617287 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.my_second_dbt_model
[0m18:50:49.620581 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.my_second_dbt_model"
[0m18:50:49.621550 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.my_second_dbt_model"
[0m18:50:49.621956 [debug] [Thread-1  ]: On model.dbt_transformation.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.my_second_dbt_model"} */
create or replace   view SKILLPATH_DB.RAW_DATA.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from SKILLPATH_DB.RAW_DATA.my_first_dbt_model
where id = 1
  );
[0m18:50:50.062312 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.439 seconds
[0m18:50:50.066564 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f9ffab5-d167-41fb-ac7b-fa663abf5dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1373582b0>]}
[0m18:50:50.067425 [info ] [Thread-1  ]: 9 of 9 OK created sql view model RAW_DATA.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.46s]
[0m18:50:50.068082 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.my_second_dbt_model
[0m18:50:50.073632 [debug] [MainThread]: Connection 'master' was left open.
[0m18:50:50.074105 [debug] [MainThread]: On master: Close
[0m18:50:50.325489 [debug] [MainThread]: Connection 'model.dbt_transformation.my_second_dbt_model' was left open.
[0m18:50:50.326737 [debug] [MainThread]: On model.dbt_transformation.my_second_dbt_model: Close
[0m18:50:51.410936 [info ] [MainThread]: 
[0m18:50:51.412403 [info ] [MainThread]: Finished running 4 project hooks, 7 table models, 2 view models in 0 hours 0 minutes and 31.50 seconds (31.50s).
[0m18:50:51.416369 [debug] [MainThread]: Command end result
[0m18:50:51.453525 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/manifest.json
[0m18:50:51.456693 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/semantic_manifest.json
[0m18:50:51.464541 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/run_results.json
[0m18:50:51.464906 [info ] [MainThread]: 
[0m18:50:51.465283 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:50:51.465599 [info ] [MainThread]: 
[0m18:50:51.465954 [error] [MainThread]:   Database Error in model udacity_courses (models/table_creation/udacity_courses.sql)
  000668 (22023): SQL compilation error:
  Invalid template: template must be a non-null JSON array
  
[0m18:50:51.466266 [info ] [MainThread]: 
[0m18:50:51.467198 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m18:50:51.479272 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 33.50121, "process_in_blocks": "0", "process_kernel_time": 0.53267, "process_mem_max_rss": "188776448", "process_out_blocks": "0", "process_user_time": 3.173119}
[0m18:50:51.479827 [debug] [MainThread]: Command `dbt run` failed at 18:50:51.479739 after 33.50 seconds
[0m18:50:51.480353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107857be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127771310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127771040>]}
[0m18:50:51.480815 [debug] [MainThread]: Flushing usage events
[0m18:50:51.618260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:25.974721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059dfbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106877400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106877220>]}


============================== 18:57:25.980938 | 6adf34de-0610-4f7a-8cc8-79ef7f1d5cd2 ==============================
[0m18:57:25.980938 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:57:25.981532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/anusreemohanan/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:57:26.954408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6adf34de-0610-4f7a-8cc8-79ef7f1d5cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b804eb0>]}
[0m18:57:27.005304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6adf34de-0610-4f7a-8cc8-79ef7f1d5cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b817850>]}
[0m18:57:27.006471 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:57:27.163567 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:57:27.334465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:57:27.335045 [debug] [MainThread]: Partial parsing: updated file: dbt_transformation://models/staging/stg_edx_courses.sql
[0m18:57:27.640459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6adf34de-0610-4f7a-8cc8-79ef7f1d5cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdb2a00>]}
[0m18:57:27.752643 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/manifest.json
[0m18:57:27.754178 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/semantic_manifest.json
[0m18:57:27.771670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6adf34de-0610-4f7a-8cc8-79ef7f1d5cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b913430>]}
[0m18:57:27.772155 [info ] [MainThread]: Found 9 models, 4 operations, 4 data tests, 2 sources, 479 macros
[0m18:57:27.772496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6adf34de-0610-4f7a-8cc8-79ef7f1d5cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bed6a60>]}
[0m18:57:27.774074 [info ] [MainThread]: 
[0m18:57:27.774428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:57:27.774718 [info ] [MainThread]: 
[0m18:57:27.775148 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:57:27.780285 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SKILLPATH_DB'
[0m18:57:27.915313 [debug] [ThreadPool]: Using snowflake connection "list_SKILLPATH_DB"
[0m18:57:27.915752 [debug] [ThreadPool]: On list_SKILLPATH_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "list_SKILLPATH_DB"} */
show terse schemas in database SKILLPATH_DB
    limit 10000
[0m18:57:27.916074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:29.021121 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.105 seconds
[0m18:57:29.023816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SKILLPATH_DB, now list_SKILLPATH_DB_RAW_DATA)
[0m18:57:29.034704 [debug] [ThreadPool]: Using snowflake connection "list_SKILLPATH_DB_RAW_DATA"
[0m18:57:29.035065 [debug] [ThreadPool]: On list_SKILLPATH_DB_RAW_DATA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "list_SKILLPATH_DB_RAW_DATA"} */
show objects in SKILLPATH_DB.RAW_DATA limit 10000;
[0m18:57:29.219549 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.184 seconds
[0m18:57:29.226843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6adf34de-0610-4f7a-8cc8-79ef7f1d5cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c490e80>]}
[0m18:57:29.239615 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_transformation.dbt_transformation-on-run-start-0"
[0m18:57:29.244622 [info ] [MainThread]: 1 of 4 START hook: dbt_transformation.on-run-start.0 ........................... [RUN]
[0m18:57:29.245298 [debug] [MainThread]: Using snowflake connection "master"
[0m18:57:29.245676 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "master"} */
CREATE or REPLACE TABLE SKILLPATH_DB.RAW_DATA.STG_EDX_RAW (RAW_CONTENT VARIANT);
[0m18:57:29.246020 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:29.915573 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.669 seconds
[0m18:57:29.918305 [info ] [MainThread]: 1 of 4 OK hook: dbt_transformation.on-run-start.0 .............................. [[32mOK[0m in 0.69s]
[0m18:57:29.928271 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_transformation.dbt_transformation-on-run-start-1"
[0m18:57:29.930524 [info ] [MainThread]: 2 of 4 START hook: dbt_transformation.on-run-start.1 ........................... [RUN]
[0m18:57:29.931647 [debug] [MainThread]: Using snowflake connection "master"
[0m18:57:29.932252 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "master"} */
COPY INTO STG_EDX_RAW FROM @SKILLPATH_DB.RAW_DATA.EDX_SCRAPED_STAGE FILE_FORMAT = (FORMAT_NAME = SKILLPATH_DB.RAW_DATA.JSON_FORMAT) ON_ERROR = 'CONTINUE';
[0m18:57:31.890874 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.958 seconds
[0m18:57:31.894336 [info ] [MainThread]: 2 of 4 OK hook: dbt_transformation.on-run-start.1 .............................. [[32mOK[0m in 1.97s]
[0m18:57:31.901594 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_transformation.dbt_transformation-on-run-start-2"
[0m18:57:31.903396 [info ] [MainThread]: 3 of 4 START hook: dbt_transformation.on-run-start.2 ........................... [RUN]
[0m18:57:31.904509 [debug] [MainThread]: Using snowflake connection "master"
[0m18:57:31.905020 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "master"} */
CREATE or REPLACE TABLE SKILLPATH_DB.RAW_DATA.STG_UDACITY_RAW (RAW_CONTENT VARIANT);
[0m18:57:32.150238 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.244 seconds
[0m18:57:32.152917 [info ] [MainThread]: 3 of 4 OK hook: dbt_transformation.on-run-start.2 .............................. [[32mOK[0m in 0.26s]
[0m18:57:32.161739 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_transformation.dbt_transformation-on-run-start-3"
[0m18:57:32.163627 [info ] [MainThread]: 4 of 4 START hook: dbt_transformation.on-run-start.3 ........................... [RUN]
[0m18:57:32.164777 [debug] [MainThread]: Using snowflake connection "master"
[0m18:57:32.165405 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "master"} */
COPY INTO STG_UDACITY_RAW FROM @SKILLPATH_DB.RAW_DATA.UDACITY_SCRAPED_STAGE FILE_FORMAT = (FORMAT_NAME = SKILLPATH_DB.RAW_DATA.JSON_FORMAT) ON_ERROR = 'CONTINUE';
[0m18:57:33.108347 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.942 seconds
[0m18:57:33.110847 [info ] [MainThread]: 4 of 4 OK hook: dbt_transformation.on-run-start.3 .............................. [[32mOK[0m in 0.96s]
[0m18:57:33.111468 [info ] [MainThread]: 
[0m18:57:33.116289 [debug] [Thread-1  ]: Began running node model.dbt_transformation.COURSERA_COURSES
[0m18:57:33.117081 [info ] [Thread-1  ]: 1 of 9 START sql table model RAW_DATA.COURSERA_COURSES ......................... [RUN]
[0m18:57:33.117943 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_SKILLPATH_DB_RAW_DATA, now model.dbt_transformation.COURSERA_COURSES)
[0m18:57:33.118469 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.COURSERA_COURSES
[0m18:57:33.124950 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.COURSERA_COURSES"
[0m18:57:33.125814 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.COURSERA_COURSES
[0m18:57:33.142932 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.COURSERA_COURSES"
[0m18:57:33.143358 [debug] [Thread-1  ]: On model.dbt_transformation.COURSERA_COURSES: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.COURSERA_COURSES"} */
CREATE OR REPLACE TABLE COURSERA_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@COURSERA_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m18:57:33.825037 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.681 seconds
[0m18:57:33.828681 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.COURSERA_COURSES"
[0m18:57:33.829612 [debug] [Thread-1  ]: On model.dbt_transformation.COURSERA_COURSES: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.COURSERA_COURSES"} */
COPY INTO COURSERA_COURSES FROM @COURSERA_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m18:57:34.806527 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.976 seconds
[0m18:57:34.822457 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.COURSERA_COURSES"
[0m18:57:34.824343 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.COURSERA_COURSES"
[0m18:57:34.824726 [debug] [Thread-1  ]: On model.dbt_transformation.COURSERA_COURSES: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.COURSERA_COURSES"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.COURSERA_COURSES
         as
        (

-- This SELECT statement is required by dbt. It simply returns the contents of the table.
SELECT * FROM COURSERA_COURSES
        );
[0m18:57:35.946298 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.121 seconds
[0m18:57:35.980329 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6adf34de-0610-4f7a-8cc8-79ef7f1d5cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5d5b80>]}
[0m18:57:35.981316 [info ] [Thread-1  ]: 1 of 9 OK created sql table model RAW_DATA.COURSERA_COURSES .................... [[32mSUCCESS 1[0m in 2.86s]
[0m18:57:35.981929 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.COURSERA_COURSES
[0m18:57:35.982349 [debug] [Thread-1  ]: Began running node model.dbt_transformation.edx_courses
[0m18:57:35.982920 [info ] [Thread-1  ]: 2 of 9 START sql table model RAW_DATA.edx_courses .............................. [RUN]
[0m18:57:35.983436 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.COURSERA_COURSES, now model.dbt_transformation.edx_courses)
[0m18:57:35.983822 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.edx_courses
[0m18:57:35.987255 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.edx_courses"
[0m18:57:35.987939 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.edx_courses
[0m18:57:35.991198 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.edx_courses"
[0m18:57:35.991608 [debug] [Thread-1  ]: On model.dbt_transformation.edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.edx_courses"} */
CREATE OR REPLACE TABLE EDX_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@EDX_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m18:57:36.509259 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.517 seconds
[0m18:57:36.512829 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.edx_courses"
[0m18:57:36.513724 [debug] [Thread-1  ]: On model.dbt_transformation.edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.edx_courses"} */
COPY INTO EDX_COURSES FROM @EDX_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m18:57:37.307210 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.792 seconds
[0m18:57:37.311398 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.edx_courses"
[0m18:57:37.314241 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.edx_courses"
[0m18:57:37.314926 [debug] [Thread-1  ]: On model.dbt_transformation.edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.edx_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.edx_courses
         as
        (
 
SELECT * FROM EDX_COURSES
        );
[0m18:57:39.080165 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.729 seconds
[0m18:57:39.158055 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6adf34de-0610-4f7a-8cc8-79ef7f1d5cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdf1070>]}
[0m18:57:39.162918 [info ] [Thread-1  ]: 2 of 9 OK created sql table model RAW_DATA.edx_courses ......................... [[32mSUCCESS 1[0m in 3.17s]
[0m18:57:39.165032 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.edx_courses
[0m18:57:39.166176 [debug] [Thread-1  ]: Began running node model.dbt_transformation.my_first_dbt_model
[0m18:57:39.167482 [info ] [Thread-1  ]: 3 of 9 START sql view model RAW_DATA.my_first_dbt_model ........................ [RUN]
[0m18:57:39.168611 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.edx_courses, now model.dbt_transformation.my_first_dbt_model)
[0m18:57:39.169575 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.my_first_dbt_model
[0m18:57:39.181918 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.my_first_dbt_model"
[0m18:57:39.183836 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.my_first_dbt_model
[0m18:57:39.249075 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.my_first_dbt_model"
[0m18:57:39.250734 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.my_first_dbt_model"
[0m18:57:39.251284 [debug] [Thread-1  ]: On model.dbt_transformation.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.my_first_dbt_model"} */
create or replace   view SKILLPATH_DB.RAW_DATA.my_first_dbt_model
  
   as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:57:39.477707 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.225 seconds
[0m18:57:39.485682 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6adf34de-0610-4f7a-8cc8-79ef7f1d5cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c587c10>]}
[0m18:57:39.486867 [info ] [Thread-1  ]: 3 of 9 OK created sql view model RAW_DATA.my_first_dbt_model ................... [[32mSUCCESS 1[0m in 0.32s]
[0m18:57:39.487586 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.my_first_dbt_model
[0m18:57:39.488069 [debug] [Thread-1  ]: Began running node model.dbt_transformation.pluralsight_courses
[0m18:57:39.488824 [info ] [Thread-1  ]: 4 of 9 START sql table model RAW_DATA.pluralsight_courses ...................... [RUN]
[0m18:57:39.489576 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.my_first_dbt_model, now model.dbt_transformation.pluralsight_courses)
[0m18:57:39.490037 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.pluralsight_courses
[0m18:57:39.495973 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.pluralsight_courses"
[0m18:57:39.498664 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.pluralsight_courses
[0m18:57:39.503065 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.pluralsight_courses"
[0m18:57:39.503575 [debug] [Thread-1  ]: On model.dbt_transformation.pluralsight_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.pluralsight_courses"} */
CREATE OR REPLACE TABLE PLURALSIGHT_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@PLURALSIGHT_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m18:57:39.918934 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.415 seconds
[0m18:57:39.921202 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.pluralsight_courses"
[0m18:57:39.921754 [debug] [Thread-1  ]: On model.dbt_transformation.pluralsight_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.pluralsight_courses"} */
COPY INTO PLURALSIGHT_COURSES FROM @PLURALSIGHT_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m18:57:40.572795 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.650 seconds
[0m18:57:40.575806 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.pluralsight_courses"
[0m18:57:40.577840 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.pluralsight_courses"
[0m18:57:40.578496 [debug] [Thread-1  ]: On model.dbt_transformation.pluralsight_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.pluralsight_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.pluralsight_courses
         as
        (
 
SELECT * FROM PLURALSIGHT_COURSES
        );
[0m18:57:41.264941 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.685 seconds
[0m18:57:41.269777 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6adf34de-0610-4f7a-8cc8-79ef7f1d5cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c587c10>]}
[0m18:57:41.271016 [info ] [Thread-1  ]: 4 of 9 OK created sql table model RAW_DATA.pluralsight_courses ................. [[32mSUCCESS 1[0m in 1.78s]
[0m18:57:41.272073 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.pluralsight_courses
[0m18:57:41.272820 [debug] [Thread-1  ]: Began running node model.dbt_transformation.stg_edx_courses
[0m18:57:41.273717 [info ] [Thread-1  ]: 5 of 9 START sql table model RAW_DATA.stg_edx_courses .......................... [RUN]
[0m18:57:41.274448 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.pluralsight_courses, now model.dbt_transformation.stg_edx_courses)
[0m18:57:41.275027 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.stg_edx_courses
[0m18:57:41.280224 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.stg_edx_courses"
[0m18:57:41.281408 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.stg_edx_courses
[0m18:57:41.284513 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.stg_edx_courses"
[0m18:57:41.288757 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.stg_edx_courses"
[0m18:57:41.289337 [debug] [Thread-1  ]: On model.dbt_transformation.stg_edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.stg_edx_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.stg_edx_courses
         as
        (WITH source AS (
    SELECT * FROM SKILLPATH_DB.RAW_DATA.STG_EDX_RAW
),

transformed AS (
    SELECT 
        UUID_STRING() AS id,
        raw_content:URL::STRING AS url,
        TRIM(raw_content:course_name::STRING) AS course_name,
        TRIM(
            REGEXP_REPLACE(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(raw_content:course_description::VARCHAR, '\\n', ' '),
                    '\\r', ' '
                ),
                '\\t', ' '
            )
        ) AS description,
        NULLIF(
            TRIM(
                CASE 
                    WHEN UPPER(raw_content:prerequisites::STRING) IN ('NOT FOUND', 'NONE', '') THEN NULL
                    ELSE raw_content:prerequisites::STRING
                END
            ), 
            ''
        ) AS prerequisites,
        CASE 
            WHEN UPPER(raw_content:prerequisites::STRING) IN ('NOT FOUND', 'NONE', 'NONE.', '') 
                 OR raw_content:prerequisites::STRING IS NULL 
            THEN FALSE
            ELSE TRUE
        END AS has_prerequisites,
        NULLIF(
            REPLACE(raw_content:associated_skills::STRING, 'Not found', ''), 
            ''
        ) AS skills,
        NULLIF(
            TRIM(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(
                        REGEXP_REPLACE(
                            REPLACE(raw_content:grow_these_skills::STRING, 'Not found', ''),
                            '\\n', ' '
                        ),
                        '\\r', ' '
                    ),
                    '\\t', ' '
                )
            ),
            ''
        ) AS grow_these_skills,
        TRIM(raw_content:institution::STRING) AS institution,
        TRIM(raw_content:level::STRING) AS level,
        CASE
            WHEN raw_content:language::STRING = 'en' THEN 'ENGLISH'
            ELSE 'OTHERS'
        END AS language,
        TRIM(raw_content:duration::STRING) AS duration,
        CASE 
            WHEN raw_content:duration::STRING LIKE '%weeks%' THEN 
                REGEXP_SUBSTR(raw_content:duration::STRING, '[0-9]+')::FLOAT * 168  -- Weeks to hours
            WHEN raw_content:duration::STRING LIKE '%week%' THEN 
                REGEXP_SUBSTR(raw_content:duration::STRING, '[0-9]+')::FLOAT * 168  -- Weeks to hours
            ELSE NULL
        END AS duration_hours,
        COALESCE(
            TRY_CAST(
                CASE 
                    WHEN raw_content:rating::STRING = 'Not found' THEN '-1'
                    ELSE raw_content:rating::STRING 
                END AS FLOAT
            ), 
            -1
        ) AS rating,
        'edX' AS source,
        CURRENT_TIMESTAMP AS ingestion_time
    FROM source
)

SELECT * FROM transformed
        );
[0m18:57:42.241164 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.944 seconds
[0m18:57:42.260508 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6adf34de-0610-4f7a-8cc8-79ef7f1d5cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c641280>]}
[0m18:57:42.262900 [info ] [Thread-1  ]: 5 of 9 OK created sql table model RAW_DATA.stg_edx_courses ..................... [[32mSUCCESS 1[0m in 0.98s]
[0m18:57:42.264291 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.stg_edx_courses
[0m18:57:42.264857 [debug] [Thread-1  ]: Began running node model.dbt_transformation.stg_udacity_courses
[0m18:57:42.266036 [info ] [Thread-1  ]: 6 of 9 START sql table model RAW_DATA.stg_udacity_courses ...................... [RUN]
[0m18:57:42.266971 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.stg_edx_courses, now model.dbt_transformation.stg_udacity_courses)
[0m18:57:42.267746 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.stg_udacity_courses
[0m18:57:42.276224 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.stg_udacity_courses"
[0m18:57:42.277273 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.stg_udacity_courses
[0m18:57:42.284686 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.stg_udacity_courses"
[0m18:57:42.288899 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.stg_udacity_courses"
[0m18:57:42.289446 [debug] [Thread-1  ]: On model.dbt_transformation.stg_udacity_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.stg_udacity_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.stg_udacity_courses
         as
        (WITH source AS (
    SELECT * FROM SKILLPATH_DB.RAW_DATA.STG_UDACITY_RAW
),

transformed AS (
    SELECT 
        UUID_STRING() AS id,
        raw_content:URL::STRING AS url,
        TRIM(raw_content:"Course Name"::STRING) AS course_name,
        TRIM(
            REGEXP_REPLACE(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(raw_content:Description::VARCHAR, '\\n', ' '),
                '\\r', ' '
            ),
            '\\t', ' '
            )
        ) AS description,
        NULLIF(ARRAY_TO_STRING(SPLIT(TRIM(raw_content:Prerequisites::STRING), ','), ', '), '') AS prerequisites,
        CASE 
            WHEN raw_content:Prerequisites::STRING IS NULL OR raw_content:Prerequisites::STRING = '' THEN FALSE
            ELSE TRUE
        END AS has_prerequisites,
        NULLIF(ARRAY_TO_STRING(SPLIT(TRIM(raw_content:Skills::STRING), ', '), ', '), '') AS skills,
        TRIM(raw_content:Level::STRING) AS level,
        CASE
            WHEN raw_content:Language::STRING LIKE 'en' THEN
            'ENGLISH'
            ELSE 'OTHERS'
         END AS language,
        CONCAT(
            REGEXP_SUBSTR(raw_content:Duration::VARCHAR, '[0-9]+'), ' ',
            CASE 
                WHEN raw_content:Duration::VARCHAR LIKE 'P%M' THEN 'months'
                WHEN raw_content:Duration::VARCHAR LIKE 'P%W' THEN 'weeks'
                WHEN raw_content:Duration::VARCHAR LIKE 'PT%H' THEN 'hours'
                ELSE 'unknown'
            END
        ) AS duration,
        CASE 
            WHEN raw_content:Duration::STRING LIKE 'P%M' THEN 
                REGEXP_SUBSTR(raw_content:Duration::STRING, '[0-9]+')::FLOAT * 730  -- Months to hours
            WHEN raw_content:Duration::STRING LIKE 'P%W' THEN 
                REGEXP_SUBSTR(raw_content:Duration::STRING, '[0-9]+')::FLOAT * 168  -- Weeks to hours
            WHEN raw_content:Duration::STRING LIKE 'PT%H' THEN 
                REGEXP_SUBSTR(raw_content:Duration::STRING, '[0-9]+')::FLOAT       -- Hours
            ELSE NULL
        END AS duration_hours,
        COALESCE(TRY_CAST(raw_content:Rating::STRING AS FLOAT),-1) AS rating,
        'Udacity' AS source,
        CURRENT_TIMESTAMP AS ingestion_time
    FROM source
)

SELECT * FROM transformed
        );
[0m18:57:43.521178 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.230 seconds
[0m18:57:43.528698 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6adf34de-0610-4f7a-8cc8-79ef7f1d5cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c683f10>]}
[0m18:57:43.530340 [info ] [Thread-1  ]: 6 of 9 OK created sql table model RAW_DATA.stg_udacity_courses ................. [[32mSUCCESS 1[0m in 1.26s]
[0m18:57:43.531538 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.stg_udacity_courses
[0m18:57:43.532136 [debug] [Thread-1  ]: Began running node model.dbt_transformation.udacity_courses
[0m18:57:43.532750 [info ] [Thread-1  ]: 7 of 9 START sql table model RAW_DATA.udacity_courses .......................... [RUN]
[0m18:57:43.533324 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.stg_udacity_courses, now model.dbt_transformation.udacity_courses)
[0m18:57:43.533775 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.udacity_courses
[0m18:57:43.538667 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.udacity_courses"
[0m18:57:43.540042 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.udacity_courses
[0m18:57:43.543889 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udacity_courses"
[0m18:57:43.544501 [debug] [Thread-1  ]: On model.dbt_transformation.udacity_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udacity_courses"} */
CREATE OR REPLACE TABLE UDACITY_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@UDACITY_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m18:57:43.810792 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01bb40e1-0204-ccc2-0003-d5630032d462
[0m18:57:43.811495 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000668 (22023): SQL compilation error:
Invalid template: template must be a non-null JSON array

[0m18:57:43.814016 [debug] [Thread-1  ]: Database Error in model udacity_courses (models/table_creation/udacity_courses.sql)
  000668 (22023): SQL compilation error:
  Invalid template: template must be a non-null JSON array
  
[0m18:57:43.814782 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6adf34de-0610-4f7a-8cc8-79ef7f1d5cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c693a60>]}
[0m18:57:43.815484 [error] [Thread-1  ]: 7 of 9 ERROR creating sql table model RAW_DATA.udacity_courses ................. [[31mERROR[0m in 0.28s]
[0m18:57:43.816089 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.udacity_courses
[0m18:57:43.816488 [debug] [Thread-1  ]: Began running node model.dbt_transformation.udemy_courses
[0m18:57:43.816986 [debug] [Thread-4  ]: Marking all children of 'model.dbt_transformation.udacity_courses' to be skipped because of status 'error'.  Reason: Database Error in model udacity_courses (models/table_creation/udacity_courses.sql)
  000668 (22023): SQL compilation error:
  Invalid template: template must be a non-null JSON array
  .
[0m18:57:43.817472 [info ] [Thread-1  ]: 8 of 9 START sql table model RAW_DATA.udemy_courses ............................ [RUN]
[0m18:57:43.818207 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.udacity_courses, now model.dbt_transformation.udemy_courses)
[0m18:57:43.818586 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.udemy_courses
[0m18:57:43.831154 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.udemy_courses"
[0m18:57:43.881423 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.udemy_courses
[0m18:57:43.885846 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udemy_courses"
[0m18:57:43.886337 [debug] [Thread-1  ]: On model.dbt_transformation.udemy_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udemy_courses"} */
CREATE OR REPLACE TABLE UDEMY_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@UDEMY_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m18:57:50.649952 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 6.762 seconds
[0m18:57:50.657464 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udemy_courses"
[0m18:57:50.658207 [debug] [Thread-1  ]: On model.dbt_transformation.udemy_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udemy_courses"} */
COPY INTO UDEMY_COURSES FROM @UDEMY_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m18:57:55.167154 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.508 seconds
[0m18:57:55.175416 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.udemy_courses"
[0m18:57:55.177904 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udemy_courses"
[0m18:57:55.178533 [debug] [Thread-1  ]: On model.dbt_transformation.udemy_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udemy_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.udemy_courses
         as
        (
 
SELECT * FROM UDEMY_COURSES
        );
[0m18:57:57.913671 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.734 seconds
[0m18:57:57.922316 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6adf34de-0610-4f7a-8cc8-79ef7f1d5cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c690160>]}
[0m18:57:57.924820 [info ] [Thread-1  ]: 8 of 9 OK created sql table model RAW_DATA.udemy_courses ....................... [[32mSUCCESS 1[0m in 14.10s]
[0m18:57:57.926192 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.udemy_courses
[0m18:57:57.927002 [debug] [Thread-1  ]: Began running node model.dbt_transformation.my_second_dbt_model
[0m18:57:57.928169 [info ] [Thread-1  ]: 9 of 9 START sql view model RAW_DATA.my_second_dbt_model ....................... [RUN]
[0m18:57:57.929095 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.udemy_courses, now model.dbt_transformation.my_second_dbt_model)
[0m18:57:57.929769 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.my_second_dbt_model
[0m18:57:57.937676 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.my_second_dbt_model"
[0m18:57:57.938841 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.my_second_dbt_model
[0m18:57:57.942676 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.my_second_dbt_model"
[0m18:57:57.943771 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.my_second_dbt_model"
[0m18:57:57.944210 [debug] [Thread-1  ]: On model.dbt_transformation.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.my_second_dbt_model"} */
create or replace   view SKILLPATH_DB.RAW_DATA.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from SKILLPATH_DB.RAW_DATA.my_first_dbt_model
where id = 1
  );
[0m18:57:58.203616 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.259 seconds
[0m18:57:58.207730 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6adf34de-0610-4f7a-8cc8-79ef7f1d5cd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c641220>]}
[0m18:57:58.209234 [info ] [Thread-1  ]: 9 of 9 OK created sql view model RAW_DATA.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.28s]
[0m18:57:58.210204 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.my_second_dbt_model
[0m18:57:58.212901 [debug] [MainThread]: Connection 'master' was left open.
[0m18:57:58.213663 [debug] [MainThread]: On master: Close
[0m18:57:58.448639 [debug] [MainThread]: Connection 'model.dbt_transformation.my_second_dbt_model' was left open.
[0m18:57:58.450171 [debug] [MainThread]: On model.dbt_transformation.my_second_dbt_model: Close
[0m18:57:58.682733 [info ] [MainThread]: 
[0m18:57:58.684143 [info ] [MainThread]: Finished running 4 project hooks, 7 table models, 2 view models in 0 hours 0 minutes and 30.91 seconds (30.91s).
[0m18:57:58.688293 [debug] [MainThread]: Command end result
[0m18:57:58.727622 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/manifest.json
[0m18:57:58.730842 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/semantic_manifest.json
[0m18:57:58.739189 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/run_results.json
[0m18:57:58.739586 [info ] [MainThread]: 
[0m18:57:58.740005 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:57:58.740339 [info ] [MainThread]: 
[0m18:57:58.740717 [error] [MainThread]:   Database Error in model udacity_courses (models/table_creation/udacity_courses.sql)
  000668 (22023): SQL compilation error:
  Invalid template: template must be a non-null JSON array
  
[0m18:57:58.741043 [info ] [MainThread]: 
[0m18:57:58.741387 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m18:57:58.745751 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 32.835423, "process_in_blocks": "0", "process_kernel_time": 0.563302, "process_mem_max_rss": "187465728", "process_out_blocks": "0", "process_user_time": 3.15562}
[0m18:57:58.746348 [debug] [MainThread]: Command `dbt run` failed at 18:57:58.746234 after 32.84 seconds
[0m18:57:58.746877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059dfbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be48c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c643430>]}
[0m18:57:58.747274 [debug] [MainThread]: Flushing usage events
[0m18:57:58.876906 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:01:58.692703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105409b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a7250>]}


============================== 19:01:58.705618 | 8baea010-5c83-4f08-90c0-d96d87fd72b8 ==============================
[0m19:01:58.705618 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:01:58.706549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/anusreemohanan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:01:59.720207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8baea010-5c83-4f08-90c0-d96d87fd72b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d38fa0>]}
[0m19:01:59.771806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8baea010-5c83-4f08-90c0-d96d87fd72b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125806f70>]}
[0m19:01:59.773279 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:01:59.970707 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:02:00.201453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:02:00.202259 [debug] [MainThread]: Partial parsing: updated file: dbt_transformation://models/staging/stg_edx_courses.sql
[0m19:02:00.546708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8baea010-5c83-4f08-90c0-d96d87fd72b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125c994f0>]}
[0m19:02:00.661532 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/manifest.json
[0m19:02:00.663216 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/semantic_manifest.json
[0m19:02:00.680897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8baea010-5c83-4f08-90c0-d96d87fd72b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125c70580>]}
[0m19:02:00.681437 [info ] [MainThread]: Found 9 models, 4 operations, 4 data tests, 2 sources, 479 macros
[0m19:02:00.681792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8baea010-5c83-4f08-90c0-d96d87fd72b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1257c7af0>]}
[0m19:02:00.683405 [info ] [MainThread]: 
[0m19:02:00.683761 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:02:00.684052 [info ] [MainThread]: 
[0m19:02:00.684493 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:02:00.689758 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SKILLPATH_DB'
[0m19:02:00.751497 [debug] [ThreadPool]: Using snowflake connection "list_SKILLPATH_DB"
[0m19:02:00.751912 [debug] [ThreadPool]: On list_SKILLPATH_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "list_SKILLPATH_DB"} */
show terse schemas in database SKILLPATH_DB
    limit 10000
[0m19:02:00.752227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:01.795412 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.043 seconds
[0m19:02:01.802875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SKILLPATH_DB, now list_SKILLPATH_DB_RAW_DATA)
[0m19:02:01.820799 [debug] [ThreadPool]: Using snowflake connection "list_SKILLPATH_DB_RAW_DATA"
[0m19:02:01.821350 [debug] [ThreadPool]: On list_SKILLPATH_DB_RAW_DATA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "list_SKILLPATH_DB_RAW_DATA"} */
show objects in SKILLPATH_DB.RAW_DATA limit 10000;
[0m19:02:02.051996 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.230 seconds
[0m19:02:02.057101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8baea010-5c83-4f08-90c0-d96d87fd72b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126e84e20>]}
[0m19:02:02.066911 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_transformation.dbt_transformation-on-run-start-0"
[0m19:02:02.070966 [info ] [MainThread]: 1 of 4 START hook: dbt_transformation.on-run-start.0 ........................... [RUN]
[0m19:02:02.071571 [debug] [MainThread]: Using snowflake connection "master"
[0m19:02:02.071935 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "master"} */
CREATE or REPLACE TABLE SKILLPATH_DB.RAW_DATA.STG_EDX_RAW (RAW_CONTENT VARIANT);
[0m19:02:02.072271 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:02:02.807478 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.735 seconds
[0m19:02:02.810744 [info ] [MainThread]: 1 of 4 OK hook: dbt_transformation.on-run-start.0 .............................. [[32mOK[0m in 0.75s]
[0m19:02:02.819049 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_transformation.dbt_transformation-on-run-start-1"
[0m19:02:02.821183 [info ] [MainThread]: 2 of 4 START hook: dbt_transformation.on-run-start.1 ........................... [RUN]
[0m19:02:02.822180 [debug] [MainThread]: Using snowflake connection "master"
[0m19:02:02.822697 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "master"} */
COPY INTO STG_EDX_RAW FROM @SKILLPATH_DB.RAW_DATA.EDX_SCRAPED_STAGE FILE_FORMAT = (FORMAT_NAME = SKILLPATH_DB.RAW_DATA.JSON_FORMAT) ON_ERROR = 'CONTINUE';
[0m19:02:04.194851 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.371 seconds
[0m19:02:04.198209 [info ] [MainThread]: 2 of 4 OK hook: dbt_transformation.on-run-start.1 .............................. [[32mOK[0m in 1.39s]
[0m19:02:04.206522 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_transformation.dbt_transformation-on-run-start-2"
[0m19:02:04.207700 [info ] [MainThread]: 3 of 4 START hook: dbt_transformation.on-run-start.2 ........................... [RUN]
[0m19:02:04.208427 [debug] [MainThread]: Using snowflake connection "master"
[0m19:02:04.208810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "master"} */
CREATE or REPLACE TABLE SKILLPATH_DB.RAW_DATA.STG_UDACITY_RAW (RAW_CONTENT VARIANT);
[0m19:02:04.483305 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.274 seconds
[0m19:02:04.486210 [info ] [MainThread]: 3 of 4 OK hook: dbt_transformation.on-run-start.2 .............................. [[32mOK[0m in 0.29s]
[0m19:02:04.496705 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_transformation.dbt_transformation-on-run-start-3"
[0m19:02:04.499371 [info ] [MainThread]: 4 of 4 START hook: dbt_transformation.on-run-start.3 ........................... [RUN]
[0m19:02:04.500521 [debug] [MainThread]: Using snowflake connection "master"
[0m19:02:04.501035 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "connection_name": "master"} */
COPY INTO STG_UDACITY_RAW FROM @SKILLPATH_DB.RAW_DATA.UDACITY_SCRAPED_STAGE FILE_FORMAT = (FORMAT_NAME = SKILLPATH_DB.RAW_DATA.JSON_FORMAT) ON_ERROR = 'CONTINUE';
[0m19:02:06.318241 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.816 seconds
[0m19:02:06.321672 [info ] [MainThread]: 4 of 4 OK hook: dbt_transformation.on-run-start.3 .............................. [[32mOK[0m in 1.83s]
[0m19:02:06.322593 [info ] [MainThread]: 
[0m19:02:06.329798 [debug] [Thread-1  ]: Began running node model.dbt_transformation.COURSERA_COURSES
[0m19:02:06.331127 [info ] [Thread-1  ]: 1 of 9 START sql table model RAW_DATA.COURSERA_COURSES ......................... [RUN]
[0m19:02:06.331954 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_SKILLPATH_DB_RAW_DATA, now model.dbt_transformation.COURSERA_COURSES)
[0m19:02:06.332731 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.COURSERA_COURSES
[0m19:02:06.339948 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.COURSERA_COURSES"
[0m19:02:06.340994 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.COURSERA_COURSES
[0m19:02:06.359619 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.COURSERA_COURSES"
[0m19:02:06.360092 [debug] [Thread-1  ]: On model.dbt_transformation.COURSERA_COURSES: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.COURSERA_COURSES"} */
CREATE OR REPLACE TABLE COURSERA_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@COURSERA_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m19:02:07.252254 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.892 seconds
[0m19:02:07.254368 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.COURSERA_COURSES"
[0m19:02:07.255038 [debug] [Thread-1  ]: On model.dbt_transformation.COURSERA_COURSES: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.COURSERA_COURSES"} */
COPY INTO COURSERA_COURSES FROM @COURSERA_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m19:02:08.107662 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.851 seconds
[0m19:02:08.127233 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.COURSERA_COURSES"
[0m19:02:08.129418 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.COURSERA_COURSES"
[0m19:02:08.129817 [debug] [Thread-1  ]: On model.dbt_transformation.COURSERA_COURSES: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.COURSERA_COURSES"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.COURSERA_COURSES
         as
        (

-- This SELECT statement is required by dbt. It simply returns the contents of the table.
SELECT * FROM COURSERA_COURSES
        );
[0m19:02:09.058249 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.928 seconds
[0m19:02:09.090433 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8baea010-5c83-4f08-90c0-d96d87fd72b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126fcad60>]}
[0m19:02:09.091271 [info ] [Thread-1  ]: 1 of 9 OK created sql table model RAW_DATA.COURSERA_COURSES .................... [[32mSUCCESS 1[0m in 2.76s]
[0m19:02:09.091873 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.COURSERA_COURSES
[0m19:02:09.092275 [debug] [Thread-1  ]: Began running node model.dbt_transformation.edx_courses
[0m19:02:09.092866 [info ] [Thread-1  ]: 2 of 9 START sql table model RAW_DATA.edx_courses .............................. [RUN]
[0m19:02:09.093392 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.COURSERA_COURSES, now model.dbt_transformation.edx_courses)
[0m19:02:09.093770 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.edx_courses
[0m19:02:09.097182 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.edx_courses"
[0m19:02:09.098173 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.edx_courses
[0m19:02:09.101292 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.edx_courses"
[0m19:02:09.101712 [debug] [Thread-1  ]: On model.dbt_transformation.edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.edx_courses"} */
CREATE OR REPLACE TABLE EDX_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@EDX_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m19:02:09.904117 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.802 seconds
[0m19:02:09.908516 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.edx_courses"
[0m19:02:09.910212 [debug] [Thread-1  ]: On model.dbt_transformation.edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.edx_courses"} */
COPY INTO EDX_COURSES FROM @EDX_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m19:02:10.812862 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.902 seconds
[0m19:02:10.814410 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.edx_courses"
[0m19:02:10.815483 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.edx_courses"
[0m19:02:10.815860 [debug] [Thread-1  ]: On model.dbt_transformation.edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.edx_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.edx_courses
         as
        (
 
SELECT * FROM EDX_COURSES
        );
[0m19:02:11.840553 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.024 seconds
[0m19:02:11.846815 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8baea010-5c83-4f08-90c0-d96d87fd72b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125d02730>]}
[0m19:02:11.848172 [info ] [Thread-1  ]: 2 of 9 OK created sql table model RAW_DATA.edx_courses ......................... [[32mSUCCESS 1[0m in 2.75s]
[0m19:02:11.849119 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.edx_courses
[0m19:02:11.849776 [debug] [Thread-1  ]: Began running node model.dbt_transformation.my_first_dbt_model
[0m19:02:11.850651 [info ] [Thread-1  ]: 3 of 9 START sql view model RAW_DATA.my_first_dbt_model ........................ [RUN]
[0m19:02:11.851476 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.edx_courses, now model.dbt_transformation.my_first_dbt_model)
[0m19:02:11.852086 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.my_first_dbt_model
[0m19:02:11.856838 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.my_first_dbt_model"
[0m19:02:11.858102 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.my_first_dbt_model
[0m19:02:11.880790 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.my_first_dbt_model"
[0m19:02:11.881965 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.my_first_dbt_model"
[0m19:02:11.882373 [debug] [Thread-1  ]: On model.dbt_transformation.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.my_first_dbt_model"} */
create or replace   view SKILLPATH_DB.RAW_DATA.my_first_dbt_model
  
   as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:02:12.090311 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.207 seconds
[0m19:02:12.093058 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8baea010-5c83-4f08-90c0-d96d87fd72b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f66550>]}
[0m19:02:12.093892 [info ] [Thread-1  ]: 3 of 9 OK created sql view model RAW_DATA.my_first_dbt_model ................... [[32mSUCCESS 1[0m in 0.24s]
[0m19:02:12.094596 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.my_first_dbt_model
[0m19:02:12.095018 [debug] [Thread-1  ]: Began running node model.dbt_transformation.pluralsight_courses
[0m19:02:12.095668 [info ] [Thread-1  ]: 4 of 9 START sql table model RAW_DATA.pluralsight_courses ...................... [RUN]
[0m19:02:12.096300 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.my_first_dbt_model, now model.dbt_transformation.pluralsight_courses)
[0m19:02:12.096700 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.pluralsight_courses
[0m19:02:12.100314 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.pluralsight_courses"
[0m19:02:12.101861 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.pluralsight_courses
[0m19:02:12.104871 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.pluralsight_courses"
[0m19:02:12.105375 [debug] [Thread-1  ]: On model.dbt_transformation.pluralsight_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.pluralsight_courses"} */
CREATE OR REPLACE TABLE PLURALSIGHT_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@PLURALSIGHT_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m19:02:12.595824 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.490 seconds
[0m19:02:12.598220 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.pluralsight_courses"
[0m19:02:12.598893 [debug] [Thread-1  ]: On model.dbt_transformation.pluralsight_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.pluralsight_courses"} */
COPY INTO PLURALSIGHT_COURSES FROM @PLURALSIGHT_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m19:02:13.396948 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.797 seconds
[0m19:02:13.401507 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.pluralsight_courses"
[0m19:02:13.404365 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.pluralsight_courses"
[0m19:02:13.405046 [debug] [Thread-1  ]: On model.dbt_transformation.pluralsight_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.pluralsight_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.pluralsight_courses
         as
        (
 
SELECT * FROM PLURALSIGHT_COURSES
        );
[0m19:02:14.867172 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.461 seconds
[0m19:02:14.873859 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8baea010-5c83-4f08-90c0-d96d87fd72b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127033fd0>]}
[0m19:02:14.875234 [info ] [Thread-1  ]: 4 of 9 OK created sql table model RAW_DATA.pluralsight_courses ................. [[32mSUCCESS 1[0m in 2.78s]
[0m19:02:14.876194 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.pluralsight_courses
[0m19:02:14.877045 [debug] [Thread-1  ]: Began running node model.dbt_transformation.stg_edx_courses
[0m19:02:14.878259 [info ] [Thread-1  ]: 5 of 9 START sql table model RAW_DATA.stg_edx_courses .......................... [RUN]
[0m19:02:14.879161 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.pluralsight_courses, now model.dbt_transformation.stg_edx_courses)
[0m19:02:14.879783 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.stg_edx_courses
[0m19:02:14.885660 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.stg_edx_courses"
[0m19:02:14.887001 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.stg_edx_courses
[0m19:02:14.891593 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.stg_edx_courses"
[0m19:02:14.896742 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.stg_edx_courses"
[0m19:02:14.897284 [debug] [Thread-1  ]: On model.dbt_transformation.stg_edx_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.stg_edx_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.stg_edx_courses
         as
        (WITH source AS (
    SELECT * FROM SKILLPATH_DB.RAW_DATA.STG_EDX_RAW
),

transformed AS (
    SELECT 
        UUID_STRING() AS id,
        raw_content:URL::STRING AS url,
        TRIM(raw_content:course_name::STRING) AS course_name,
        TRIM(
            REGEXP_REPLACE(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(raw_content:course_description::VARCHAR, '\\n', ' '),
                    '\\r', ' '
                ),
                '\\t', ' '
            )
        ) AS description,
        NULLIF(
            TRIM(
                CASE 
                    WHEN UPPER(REGEXP_REPLACE(raw_content:prerequisites::STRING, '\\.', '')) IN ('NOT FOUND', 'NONE', '') 
                    THEN NULL
                    ELSE raw_content:prerequisites::STRING
                END
            ), 
            ''
        ) AS prerequisites,
        CASE 
            WHEN UPPER(REGEXP_REPLACE(raw_content:prerequisites::STRING, '\\.', '')) IN ('NOT FOUND', 'NONE', '') 
                 OR raw_content:prerequisites::STRING IS NULL 
            THEN FALSE
            ELSE TRUE
        END AS has_prerequisites,
        NULLIF(
            REPLACE(raw_content:associated_skills::STRING, 'Not found', ''), 
            ''
        ) AS skills,
        NULLIF(
            TRIM(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(
                        REGEXP_REPLACE(
                            REPLACE(raw_content:grow_these_skills::STRING, 'Not found', ''),
                            '\\n', ' '
                        ),
                        '\\r', ' '
                    ),
                    '\\t', ' '
                )
            ),
            ''
        ) AS grow_these_skills,
        TRIM(raw_content:institution::STRING) AS institution,
        TRIM(raw_content:level::STRING) AS level,
        CASE
            WHEN raw_content:language::STRING = 'en' THEN 'ENGLISH'
            ELSE 'OTHERS'
        END AS language,
        TRIM(raw_content:duration::STRING) AS duration,
        CASE 
            WHEN raw_content:duration::STRING LIKE '%weeks%' THEN 
                REGEXP_SUBSTR(raw_content:duration::STRING, '[0-9]+')::FLOAT * 168  -- Weeks to hours
            WHEN raw_content:duration::STRING LIKE '%week%' THEN 
                REGEXP_SUBSTR(raw_content:duration::STRING, '[0-9]+')::FLOAT * 168  -- Weeks to hours
            ELSE NULL
        END AS duration_hours,
        COALESCE(
            TRY_CAST(
                CASE 
                    WHEN raw_content:rating::STRING = 'Not found' THEN '-1'
                    ELSE raw_content:rating::STRING 
                END AS FLOAT
            ), 
            -1
        ) AS rating,
        'edX' AS source,
        CURRENT_TIMESTAMP AS ingestion_time
    FROM source
)

SELECT * FROM transformed
        );
[0m19:02:16.373448 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.475 seconds
[0m19:02:16.379820 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8baea010-5c83-4f08-90c0-d96d87fd72b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127011880>]}
[0m19:02:16.381251 [info ] [Thread-1  ]: 5 of 9 OK created sql table model RAW_DATA.stg_edx_courses ..................... [[32mSUCCESS 1[0m in 1.50s]
[0m19:02:16.382099 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.stg_edx_courses
[0m19:02:16.382995 [debug] [Thread-1  ]: Began running node model.dbt_transformation.stg_udacity_courses
[0m19:02:16.384084 [info ] [Thread-1  ]: 6 of 9 START sql table model RAW_DATA.stg_udacity_courses ...................... [RUN]
[0m19:02:16.384968 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.stg_edx_courses, now model.dbt_transformation.stg_udacity_courses)
[0m19:02:16.385590 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.stg_udacity_courses
[0m19:02:16.391485 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.stg_udacity_courses"
[0m19:02:16.392781 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.stg_udacity_courses
[0m19:02:16.397006 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.stg_udacity_courses"
[0m19:02:16.400344 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.stg_udacity_courses"
[0m19:02:16.400922 [debug] [Thread-1  ]: On model.dbt_transformation.stg_udacity_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.stg_udacity_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.stg_udacity_courses
         as
        (WITH source AS (
    SELECT * FROM SKILLPATH_DB.RAW_DATA.STG_UDACITY_RAW
),

transformed AS (
    SELECT 
        UUID_STRING() AS id,
        raw_content:URL::STRING AS url,
        TRIM(raw_content:"Course Name"::STRING) AS course_name,
        TRIM(
            REGEXP_REPLACE(
                REGEXP_REPLACE(
                    REGEXP_REPLACE(raw_content:Description::VARCHAR, '\\n', ' '),
                '\\r', ' '
            ),
            '\\t', ' '
            )
        ) AS description,
        NULLIF(ARRAY_TO_STRING(SPLIT(TRIM(raw_content:Prerequisites::STRING), ','), ', '), '') AS prerequisites,
        CASE 
            WHEN raw_content:Prerequisites::STRING IS NULL OR raw_content:Prerequisites::STRING = '' THEN FALSE
            ELSE TRUE
        END AS has_prerequisites,
        NULLIF(ARRAY_TO_STRING(SPLIT(TRIM(raw_content:Skills::STRING), ', '), ', '), '') AS skills,
        TRIM(raw_content:Level::STRING) AS level,
        CASE
            WHEN raw_content:Language::STRING LIKE 'en' THEN
            'ENGLISH'
            ELSE 'OTHERS'
         END AS language,
        CONCAT(
            REGEXP_SUBSTR(raw_content:Duration::VARCHAR, '[0-9]+'), ' ',
            CASE 
                WHEN raw_content:Duration::VARCHAR LIKE 'P%M' THEN 'months'
                WHEN raw_content:Duration::VARCHAR LIKE 'P%W' THEN 'weeks'
                WHEN raw_content:Duration::VARCHAR LIKE 'PT%H' THEN 'hours'
                ELSE 'unknown'
            END
        ) AS duration,
        CASE 
            WHEN raw_content:Duration::STRING LIKE 'P%M' THEN 
                REGEXP_SUBSTR(raw_content:Duration::STRING, '[0-9]+')::FLOAT * 730  -- Months to hours
            WHEN raw_content:Duration::STRING LIKE 'P%W' THEN 
                REGEXP_SUBSTR(raw_content:Duration::STRING, '[0-9]+')::FLOAT * 168  -- Weeks to hours
            WHEN raw_content:Duration::STRING LIKE 'PT%H' THEN 
                REGEXP_SUBSTR(raw_content:Duration::STRING, '[0-9]+')::FLOAT       -- Hours
            ELSE NULL
        END AS duration_hours,
        COALESCE(TRY_CAST(raw_content:Rating::STRING AS FLOAT),-1) AS rating,
        'Udacity' AS source,
        CURRENT_TIMESTAMP AS ingestion_time
    FROM source
)

SELECT * FROM transformed
        );
[0m19:02:17.258396 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.857 seconds
[0m19:02:17.261679 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8baea010-5c83-4f08-90c0-d96d87fd72b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127076eb0>]}
[0m19:02:17.262657 [info ] [Thread-1  ]: 6 of 9 OK created sql table model RAW_DATA.stg_udacity_courses ................. [[32mSUCCESS 1[0m in 0.88s]
[0m19:02:17.263581 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.stg_udacity_courses
[0m19:02:17.264130 [debug] [Thread-1  ]: Began running node model.dbt_transformation.udacity_courses
[0m19:02:17.264860 [info ] [Thread-1  ]: 7 of 9 START sql table model RAW_DATA.udacity_courses .......................... [RUN]
[0m19:02:17.265544 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.stg_udacity_courses, now model.dbt_transformation.udacity_courses)
[0m19:02:17.265966 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.udacity_courses
[0m19:02:17.270620 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.udacity_courses"
[0m19:02:17.271573 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.udacity_courses
[0m19:02:17.274776 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udacity_courses"
[0m19:02:17.275176 [debug] [Thread-1  ]: On model.dbt_transformation.udacity_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udacity_courses"} */
CREATE OR REPLACE TABLE UDACITY_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@UDACITY_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m19:02:17.529556 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01bb40e6-0204-c8b8-0003-d5630032e2fe
[0m19:02:17.530271 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000668 (22023): SQL compilation error:
Invalid template: template must be a non-null JSON array

[0m19:02:17.532793 [debug] [Thread-1  ]: Database Error in model udacity_courses (models/table_creation/udacity_courses.sql)
  000668 (22023): SQL compilation error:
  Invalid template: template must be a non-null JSON array
  
[0m19:02:17.533532 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8baea010-5c83-4f08-90c0-d96d87fd72b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1270897c0>]}
[0m19:02:17.534341 [error] [Thread-1  ]: 7 of 9 ERROR creating sql table model RAW_DATA.udacity_courses ................. [[31mERROR[0m in 0.27s]
[0m19:02:17.534981 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.udacity_courses
[0m19:02:17.535417 [debug] [Thread-1  ]: Began running node model.dbt_transformation.udemy_courses
[0m19:02:17.536023 [debug] [Thread-4  ]: Marking all children of 'model.dbt_transformation.udacity_courses' to be skipped because of status 'error'.  Reason: Database Error in model udacity_courses (models/table_creation/udacity_courses.sql)
  000668 (22023): SQL compilation error:
  Invalid template: template must be a non-null JSON array
  .
[0m19:02:17.536585 [info ] [Thread-1  ]: 8 of 9 START sql table model RAW_DATA.udemy_courses ............................ [RUN]
[0m19:02:17.537412 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.udacity_courses, now model.dbt_transformation.udemy_courses)
[0m19:02:17.537838 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.udemy_courses
[0m19:02:17.541992 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.udemy_courses"
[0m19:02:17.542723 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.udemy_courses
[0m19:02:17.545742 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udemy_courses"
[0m19:02:17.546148 [debug] [Thread-1  ]: On model.dbt_transformation.udemy_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udemy_courses"} */
CREATE OR REPLACE TABLE UDEMY_COURSES USING TEMPLATE ( SELECT ARRAY_AGG(OBJECT_CONSTRUCT(*)) FROM TABLE( INFER_SCHEMA( LOCATION=>'@UDEMY_STAGE', FILE_FORMAT=>'inferSchema', IGNORE_CASE=>TRUE ) ) );
[0m19:02:24.457440 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 6.910 seconds
[0m19:02:24.463432 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udemy_courses"
[0m19:02:24.464003 [debug] [Thread-1  ]: On model.dbt_transformation.udemy_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udemy_courses"} */
COPY INTO UDEMY_COURSES FROM @UDEMY_STAGE FILE_FORMAT=(FORMAT_NAME='inferSchema') MATCH_BY_COLUMN_NAME=CASE_INSENSITIVE;
[0m19:02:31.277793 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 6.813 seconds
[0m19:02:31.284543 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.udemy_courses"
[0m19:02:31.287098 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.udemy_courses"
[0m19:02:31.287776 [debug] [Thread-1  ]: On model.dbt_transformation.udemy_courses: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.udemy_courses"} */
create or replace transient table SKILLPATH_DB.RAW_DATA.udemy_courses
         as
        (
 
SELECT * FROM UDEMY_COURSES
        );
[0m19:02:34.880412 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.592 seconds
[0m19:02:34.890472 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8baea010-5c83-4f08-90c0-d96d87fd72b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127086460>]}
[0m19:02:34.892678 [info ] [Thread-1  ]: 8 of 9 OK created sql table model RAW_DATA.udemy_courses ....................... [[32mSUCCESS 1[0m in 17.35s]
[0m19:02:34.893826 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.udemy_courses
[0m19:02:34.894597 [debug] [Thread-1  ]: Began running node model.dbt_transformation.my_second_dbt_model
[0m19:02:34.895800 [info ] [Thread-1  ]: 9 of 9 START sql view model RAW_DATA.my_second_dbt_model ....................... [RUN]
[0m19:02:34.896771 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_transformation.udemy_courses, now model.dbt_transformation.my_second_dbt_model)
[0m19:02:34.897411 [debug] [Thread-1  ]: Began compiling node model.dbt_transformation.my_second_dbt_model
[0m19:02:34.905517 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_transformation.my_second_dbt_model"
[0m19:02:34.906443 [debug] [Thread-1  ]: Began executing node model.dbt_transformation.my_second_dbt_model
[0m19:02:34.919469 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_transformation.my_second_dbt_model"
[0m19:02:34.926909 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_transformation.my_second_dbt_model"
[0m19:02:34.927556 [debug] [Thread-1  ]: On model.dbt_transformation.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_transformation", "target_name": "dev", "node_id": "model.dbt_transformation.my_second_dbt_model"} */
create or replace   view SKILLPATH_DB.RAW_DATA.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from SKILLPATH_DB.RAW_DATA.my_first_dbt_model
where id = 1
  );
[0m19:02:35.187404 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.259 seconds
[0m19:02:35.191522 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8baea010-5c83-4f08-90c0-d96d87fd72b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127012610>]}
[0m19:02:35.192805 [info ] [Thread-1  ]: 9 of 9 OK created sql view model RAW_DATA.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.29s]
[0m19:02:35.193761 [debug] [Thread-1  ]: Finished running node model.dbt_transformation.my_second_dbt_model
[0m19:02:35.195779 [debug] [MainThread]: Connection 'master' was left open.
[0m19:02:35.196263 [debug] [MainThread]: On master: Close
[0m19:02:35.428026 [debug] [MainThread]: Connection 'model.dbt_transformation.my_second_dbt_model' was left open.
[0m19:02:35.428991 [debug] [MainThread]: On model.dbt_transformation.my_second_dbt_model: Close
[0m19:02:35.686470 [info ] [MainThread]: 
[0m19:02:35.687780 [info ] [MainThread]: Finished running 4 project hooks, 7 table models, 2 view models in 0 hours 0 minutes and 35.00 seconds (35.00s).
[0m19:02:35.691651 [debug] [MainThread]: Command end result
[0m19:02:35.739714 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/manifest.json
[0m19:02:35.745156 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/semantic_manifest.json
[0m19:02:35.753582 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/anusreemohanan/Documents/GitHub/SkillPathAI/etl/transform/dbt_transformation/target/run_results.json
[0m19:02:35.753976 [info ] [MainThread]: 
[0m19:02:35.754363 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:02:35.754674 [info ] [MainThread]: 
[0m19:02:35.755039 [error] [MainThread]:   Database Error in model udacity_courses (models/table_creation/udacity_courses.sql)
  000668 (22023): SQL compilation error:
  Invalid template: template must be a non-null JSON array
  
[0m19:02:35.755358 [info ] [MainThread]: 
[0m19:02:35.755687 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m19:02:35.806722 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 37.184185, "process_in_blocks": "0", "process_kernel_time": 0.562255, "process_mem_max_rss": "189743104", "process_out_blocks": "0", "process_user_time": 3.245748}
[0m19:02:35.807389 [debug] [MainThread]: Command `dbt run` failed at 19:02:35.807290 after 37.19 seconds
[0m19:02:35.807955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105409b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d38fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125c70580>]}
[0m19:02:35.808496 [debug] [MainThread]: Flushing usage events
[0m19:02:35.962697 [debug] [MainThread]: An error was encountered while trying to flush usage events
